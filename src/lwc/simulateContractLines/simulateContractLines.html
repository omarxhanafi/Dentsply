<template>
    <!--Discount Model Selection section-->
  <template if:false={isInsert}>
    <template if:true={showButtons}>
      <button class="slds-button slds-button_brand slds-button_stretch" onclick={simulateContract}>{labels.REFRESH_SIMULATION}</button>
    </template>
    
  </template>
  <template if:true={showSelectDiscountModel}>
    <template if:true={noDiscountsToSelect}>
      {labels.SELECT_PRODUCT}
      <template for:each={discountModelOptionsToSelect} for:item="discountModel" for:index="index">
        <div key={discountModel.Id} >
            <lightning-tile class="slds-box slds-box_small">
                <lightning-input type="checkbox" data-index={index}
                                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                                checked={discountModel.isSelected} onchange={handleSelectChange} > </lightning-input>
                                {discountModel.Product__c}
            </lightning-tile>
        </div>
      </template>
      {labels.SELECT_SOURCE_RECORD}
      <template for:each={sourceRecords} for:item="sourceRecord" for:index="index">
        <div key={sourceRecord.Id} >
            <lightning-tile class="slds-box slds-box_small">
                <lightning-input type="checkbox" data-index={index}
                                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                                checked={sourceRecord.isSelected} onchange={handleSelectChangeRecords} > </lightning-input>
                                {sourceRecord.Combined_Fields__c}
            </lightning-tile>
        </div>    
      </template>
      <template if:true={showButtons}>
        <button class="slds-button slds-button_brand slds-button_stretch" onclick={simulateContract} disabled={disableSimulateButton}>{labels.SIMULATE_CONTRACT}</button>
      </template>
      


      

    </template>
    <template if:true={showCurrentlyAddedItems}>
      {labels.ALREADY_ADDED_iTEMS}
      <template for:each={currentlyAddedItems} for:item="ContractItem">
        <div key={ContractItem.Id}>
            <a onclick={goToContractItem} data-id={ContractItem.Id} >{ContractItem.Name}</a>
        </div>
      </template>

    </template>
    
    
  </template>

  <template if:true={showSimulationTable}>
    <div>
      <table class="slds-table slds-table_cell-buffer slds-table_bordered"> <!-- peers segmentation-->
        <caption> </caption>
        <tbody>
          <tr>
            <th style="background-color: rgb(212, 212, 106)">
              <div>
                {contractItemObjectInfo.data.fields.Segmentation__c.label}
              </div>
            </th>
            <td style="background-color: rgb(241, 241, 144)">
              <div>
                {contractItem.Segmentation__c}
              </div>
            </td>
            <td style="background-color: rgb(245, 245, 175)">
              <div>
                <lightning-formatted-number value={contractItem.SegmentationDiscount__c}></lightning-formatted-number> %
              </div>
            </td>
          </tr>

          <tr>
            <th style="background-color: rgb(212, 212, 106)">
              <div>
                {contractItemObjectInfo.data.fields.TotalNetSales__c.label}
              </div>
            </th>
            <td style="background-color: rgb(241, 241, 144)">
              <div>
                <lightning-formatted-number value={contractItem.TotalNetSales__c} format-style="currency" currency-code={contractItem.CurrencyIsoCode}></lightning-formatted-number>
              </div>
            </td>
            <td style="background-color: rgb(245, 245, 175)">
              <div>
                <lightning-formatted-number value={contractItem.TotalNetSalesDiscount__c} ></lightning-formatted-number> %
              </div>
            </td>
          </tr>


          <tr>
            <th style="background-color: rgb(212, 212, 106)">
              <div>
                {contractItemObjectInfo.data.fields.PGsPurchased__c.label}
              </div>
            </th>
            <td style="background-color: rgb(241, 241, 144)">
              <div>
                {contractItem.PGsPurchased__c} PGs
              </div>
            </td>
            <td style="background-color: rgb(245, 245, 175)">
              <div>
                <lightning-formatted-number value={contractItem.PGsPurchasedDiscount__c} ></lightning-formatted-number> %
              </div>
            </td>
          </tr>
          <tr>
            <th style="background-color: rgb(212, 212, 106)">
              <div>
                {contractItemObjectInfo.data.fields.Growth__c.label} <br>
                ({contractItemObjectInfo.data.fields.TotalNetSales2YAgo__c.label})
              </div>
            </th>
            <td style="background-color: rgb(241, 241, 144)">
              <div>
                <lightning-formatted-number value={contractItem.Growth__c} ></lightning-formatted-number> % <br>
                (<lightning-formatted-number value={contractItem.TotalNetSales2YAgo__c} format-style="currency" currency-code={contractItem.CurrencyIsoCode}></lightning-formatted-number>)
              </div>
            </td>
            <td style="background-color: rgb(245, 245, 175)">
              <div>
                <lightning-formatted-number value={contractItem.GrowthDiscount__c} ></lightning-formatted-number> %
              </div>
            </td>
          </tr>
          <tr>
            <th style="background-color: rgb(212, 212, 106)">
              <div>
                {contractItemObjectInfo.data.fields.ofYearsPurchasingFromDS__c.label}
              </div>
            </th>
            <td style="background-color: rgb(241, 241, 144)">
              <div>
                {contractItem.ofYearsPurchasingFromDS__c} {labels.YEARS}
              </div>
            </td>
            <td style="background-color: rgb(245, 245, 175)">
              <div>
                <lightning-formatted-number value={contractItem.ofYearsPurchasingFromDSDiscount__c} ></lightning-formatted-number> %
                
              </div>
            </td>
          </tr>

          <tr>
            <th style="background-color: rgb(82, 207, 77)">
              <div>
                {contractItemObjectInfo.data.fields.RecommendedDiscount__c.label}
              </div>
            </th>
            <td style="background-color: rgb(18, 235, 11)">
              <div>
                <lightning-formatted-number value={contractItem.RecommendedDiscount__c} ></lightning-formatted-number> %
              </div>
            </td>
            <td style="background-color: rgb(144, 236, 243)">
              <div>
                <lightning-input type="number" name="seven" 
                value={contractItem.OfferedDiscount__c} onchange={handleDiscountUpdate} 
                step="0.5" min=0 max={maxDiscountToOffer}
                placeholder="Change Discount..." label={contractItemObjectInfo.data.fields.OfferedDiscount__c.label}  ></lightning-input>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div>
      
      <table class="slds-table slds-table_cell-buffer slds-table_bordered" > <!-- PG groups table -->
        <caption>{labels.PG_DISTRIBUTION}</caption>
        <tbody>
          <tr>
            <th class="th10" style="background-color: rgb(214, 141, 57)" >
              <div>
                <lightning-input type="checkbox"
                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                checked={contractItem.TGImplantSystem__c} disabled=true > </lightning-input>
              </div>
            </th>
            <td class="td10" style="background-color: rgb(216, 183, 74)" >
              <div>
                {contractItemObjectInfo.data.fields.TGImplantSystem__c.label}
              </div>
            </td>
          </tr>
          <tr>
            <th class="th10" style="background-color: rgb(214, 141, 57)" >
              <div>
                <lightning-input type="checkbox"
                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                checked={contractItem.TGOssix__c} disabled=true > </lightning-input> 
              </div>
            </th>
            <td class="td10" style="background-color: rgb(216, 183, 74)">
              <div>
                {contractItemObjectInfo.data.fields.TGOssix__c.label}
              </div>
            </td>
          </tr>
          
          <tr>
            <th class="th10" style="background-color: rgb(223, 167, 104)">
              <div>
                <lightning-input type="checkbox"
                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                checked={contractItem.TGAtlantisManuallyUpdated__c} onchange={handleSelectAtlantis} > </lightning-input>
              </div>
            </th>
            <td class="td10" style="background-color: rgb(230, 214, 163)">
              <div>
                {contractItemObjectInfo.data.fields.TGAtlantis__c.label}
              </div>
            </td>
          </tr>
          <tr>
            <th class="th10" style="background-color: rgb(223, 167, 104)">
              <div>
                <lightning-input type="checkbox"
                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                checked={contractItem.TGSimplantManuallyUpdated__c} onchange={handleSelectSimplant} > </lightning-input>
              </div>
            </th>
            <td class="td10" style="background-color: rgb(230, 214, 163)">
              <div>
                {contractItemObjectInfo.data.fields.TGSimplant__c.label}
              </div>
            </td>
          </tr>
          <tr>
            <th class="th10" style="background-color: rgb(223, 167, 104)">
              <div>
                <lightning-input type="checkbox"
                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                checked={contractItem.TGCBCTManuallyUpdated__c} onchange={handleSelectCBCT} > </lightning-input>
              </div>
            </th>
            <td class="td10" style="background-color: rgb(230, 214, 163)">
              <div>
                {contractItemObjectInfo.data.fields.TGCBCT__c.label}
              </div>
            </td>
          </tr>
          
          <tr>
            <th class="th10" style="background-color: rgb(223, 167, 104)">
              <div>
                <lightning-input type="checkbox"
                variant="label-hidden" class="slds-m-left_xx-small slds-float_left .slds-align_absolute-center"
                checked={contractItem.TGPrimescanManuallyUpdated__c} onchange={handleSelectPrimescan} > </lightning-input>
              </div>
            </th>
            <td class="td10" style="background-color: rgb(230, 214, 163)">
              <div >
                {contractItemObjectInfo.data.fields.TGPrimescan__c.label}
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <template if:true={enableCommentSection}>
      <div class="slds-m-top_medium slds-m-bottom_x-large">
        
        <div class="slds-p-around_medium lgc-bg">
            <lightning-input type="text" required=true label={contractItemObjectInfo.data.fields.Comments__c.label} onchange={handleInputMassageChange}></lightning-input>
        </div>
  
      </div>
    </template>
    

    <template if:true={showButtons}>
      <button class="slds-button slds-button_brand slds-button_stretch" disabled={disableSavebutton} onclick={handleSaveSimulation}>{labels.SAVE_CONTRACT}</button>
    </template>
    

    
  </template>
  <template if:true={showSalesCalculation}>
    {SALESCALCULATIONMESSAGE}
  </template> 
  <template if:true={errorMessage}>
    <div style="color:rgb(255, 0, 0);">
      {labels.ERROR}: {errorMessage}
    </div>
  </template>
      
</template>