["{}","{\"nodes\":{\"AGGREGATE1_copy0\":{\"sources\":[\"EXTRACT0_copy0\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"Year\",\"Month\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"MAX_Date_sec_epoch\",\"action\":\"MAX\",\"source\":\"Date_sec_epoch\",\"label\":\"Maximum Date_sec_epoch\"}]}},\"FORMULA35\":{\"sources\":[\"EXTRACT10\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(Invoice_Date__c_YEAR,'-',Invoice_Date__c_MONTH)\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"YearMonth\",\"label\":\"Year-Month\",\"type\":\"TEXT\"}]}},\"AGGREGATE11\":{\"sources\":[\"EXTRACT5\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"LastBuyQty_1\",\"action\":\"MAX\",\"source\":\"MAX_Calendar.MonthEnd\",\"label\":\"LastBuyQty\"},{\"name\":\"FirstBuyQty_1\",\"action\":\"MIN\",\"source\":\"MAX_Calendar.MonthEnd\",\"label\":\"FirstBuyQty\"}]}},\"FORMULA30\":{\"sources\":[\"FORMULA29\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" < \\\"Calendar.ActiveRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.LostSalesRange_Date\\\"\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_LostQuantity12M\",\"scale\":0,\"label\":\"Lost Quantity 12M\",\"type\":\"NUMBER\"}]}},\"FORMULA31\":{\"sources\":[\"FORMULA30\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" < \\\"Calendar.ActiveRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.LostSalesRange_Date\\\"\\r\\n\\tthen \\\"ASD.Sales\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_LostSales12M\",\"scale\":2,\"label\":\"Lost Sales 12M\",\"type\":\"NUMBER\"}]}},\"FORMULA32\":{\"sources\":[\"FORMULA31\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" < \\\"Calendar.ActiveRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.LostSalesRange_Date\\\"\\r\\n\\tthen \\\"ASD.Sales_USD\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_LostSales12M_USD\",\"scale\":2,\"label\":\"Lost Sales 12M (USD)\",\"type\":\"NUMBER\"}]}},\"FORMULA33\":{\"sources\":[\"EDIT_ATTRIBUTES6\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"to_timestamp(concat(\\\"Calendar.Year\\\",'-', \\\"Calendar.Month\\\", '-01'), 'yyyy-MM-dd')\",\"defaultValue\":\"\",\"name\":\"Date\",\"format\":\"yyyy-MM-dd\",\"label\":\"Date\",\"type\":\"DATETIME\"}]}},\"FORMULA34\":{\"sources\":[\"JOIN7\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(\\\"WonBrands.Product2Sales.Global.Brand__c\\\")\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"WonBrands\",\"label\":\"Won Brands\",\"type\":\"TEXT\"}]}},\"OUTPUT0\":{\"sources\":[\"FORMULA33\"],\"action\":\"save\",\"parameters\":{\"measuresToCurrencies\":[],\"fields\":[],\"dataset\":{\"name\":\"WonLostCustomersSBU\",\"label\":\"Won/Lost Customers by SBU\",\"folderName\":\"Shared_Datasets\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET3\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Volume_Implants__c\",\"OneSF_Id__c\",\"Name\",\"Country__c\",\"gaa.Hierarchy.RegionName\",\"gaa.Hierarchy.Region.RegionManager\",\"gaa.Hierarchy.AreaName\",\"gaa.Hierarchy.Area.AreaDirector\",\"gaa.Hierarchy.Territory.TerritoryManager\",\"gaa.Hierarchy.TerritoryName\"],\"sampleDetails\":{\"filters\":{\"filterExpressions\":[{\"operands\":[\"SF0006706\"],\"field\":\"OneSF_Id__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"}]},\"type\":\"Custom\"},\"dataset\":{\"name\":\"Accounts\",\"label\":\"Accounts\",\"type\":\"analyticsDataset\"}}},\"EDIT_ATTRIBUTES5\":{\"sources\":[\"SPLIT0\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"Calendar.Year\",\"label\":\"Year\"},\"name\":\"Calendar.YearMonth_split\"}]}},\"LOAD_DATASET1\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Month\",\"Today\",\"Year\"],\"sampleDetails\":{\"sortBy\":[],\"filters\":{\"filterExpressions\":[{\"operands\":[\"2020\"],\"field\":\"Year\",\"type\":\"TEXT\",\"operator\":\"GREATER_OR_EQUAL\"}]},\"type\":\"Custom\"},\"dataset\":{\"name\":\"Calendar\",\"label\":\"Calendar\",\"type\":\"analyticsDataset\"}}},\"EDIT_ATTRIBUTES4\":{\"sources\":[\"EDIT_ATTRIBUTES0\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"CutOffMonthEnd_Date\",\"label\":\"CutOffMonthEnd_Date\"},\"name\":\"CutOffMonth.MIN_MAX_Date_sec_epoch\"}]}},\"FORMULA0_copy0\":{\"sources\":[\"FILTER0_copy0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"to_unix_timestamp(Today) + 86399\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Date_sec_epoch\",\"scale\":0,\"label\":\"Date_sec_epoch\",\"type\":\"NUMBER\"}]}},\"LOAD_DATASET0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Product2Sales.Global.SBU_Name__c\",\"ac.Country__c\",\"Product2Sales.Global.PG4_Code__c\",\"time.isCR12\",\"Invoice_Date__c\",\"ac.OneSF_Id__c\",\"ac.Id\",\"Product2Sales.Global.Brand__c\",\"Product2Sales.Global.PG2_Code__c\",\"Total_Price_USD\",\"Total_Value__c\",\"Quantity__c\"],\"sampleDetails\":{\"filters\":{\"filterExpressions\":[{\"operands\":[\"1577836800000\"],\"field\":\"Invoice_Date__c\",\"type\":\"DATETIME\",\"operator\":\"GREATER_OR_EQUAL\"},{\"operands\":[\"SF0006706\"],\"field\":\"ac.OneSF_Id__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"}]},\"type\":\"Custom\"},\"dataset\":{\"name\":\"AccountSalesDetail\",\"label\":\"Account Sales Detail - v2\",\"type\":\"analyticsDataset\"}}},\"EDIT_ATTRIBUTES6\":{\"sources\":[\"EDIT_ATTRIBUTES5\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"Calendar.Month\",\"label\":\"Month\"},\"name\":\"Calendar.YearMonth_split1\"}]}},\"EDIT_ATTRIBUTES1\":{\"sources\":[\"AGGREGATE1_copy0\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"InvoiceYear\",\"label\":\"InvoiceYear\"},\"name\":\"Year\"}]}},\"EDIT_ATTRIBUTES0\":{\"sources\":[\"FORMULA25\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"MonthEnd\",\"label\":\"MonthEnd\"},\"name\":\"MAX_Date_sec_epoch\"}]}},\"EDIT_ATTRIBUTES3\":{\"sources\":[\"EDIT_ATTRIBUTES2\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"MAX_InvoiceDate_sec_epoch\",\"label\":\"MAX_InvoiceDate_sec_epoch\"},\"name\":\"MAX_Date_sec_epoch\"}]}},\"EDIT_ATTRIBUTES2\":{\"sources\":[\"EDIT_ATTRIBUTES1\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"InvoiceMonth\",\"label\":\"InvoiceMonth\"},\"name\":\"Month\"}]}},\"FORMULA24\":{\"sources\":[\"FORMULA16\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the last day of the month 12 months in the future. This is going to define the range to calculate the future 12M turnover each month.*/\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch + (86400 * 31 * 11)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch + (86400 * 31 * 11)))), '-01'), 'yyyy-MM-dd') - 1\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"WonSalesRange_Date\",\"scale\":0,\"label\":\"WonSalesRange_Date\",\"type\":\"NUMBER\"}]}},\"EXTRACT0\":{\"sources\":[\"FORMULA13\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"FORMULA25\":{\"sources\":[\"FORMULA24\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the last day of the month 12 months in the future. This is going to define the range to calculate the future 12M turnover each month.*/\\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch + (86400 * 31 * 11)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch + (86400 * 31 * 11)))), '-01'), 'yyyy-MM-dd') - 1\\r\\n\\r\\n), 'yyyy-MM-dd')\",\"defaultValue\":\"\",\"name\":\"WonSalesRange_Helper\",\"format\":\"yyyy-MM-dd\",\"label\":\"WonSalesRange_Helper\",\"type\":\"DATETIME\"}]}},\"FORMULA26\":{\"sources\":[\"FORMULA18\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(\\\"Year\\\",'-',\\\"Month\\\")\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"YearMonth\",\"label\":\"Year-Month\",\"type\":\"TEXT\"}]}},\"FORMULA27\":{\"sources\":[\"FORMULA23\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= \\\"Calendar.WonSalesRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.BuyRange_Date\\\"\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_WonQuantity12M\",\"scale\":0,\"label\":\"Won Quantity 12M\",\"type\":\"NUMBER\"}]}},\"FORMULA28\":{\"sources\":[\"FORMULA27\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= \\\"Calendar.WonSalesRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.BuyRange_Date\\\"\\r\\n\\tthen \\\"ASD.Sales\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_WonSales12M\",\"scale\":2,\"label\":\"Won Sales 12M\",\"type\":\"NUMBER\"}]}},\"FORMULA29\":{\"sources\":[\"FORMULA28\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= \\\"Calendar.WonSalesRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.BuyRange_Date\\\"\\r\\n\\tthen \\\"ASD.Sales_USD\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_WonSales12M_USD\",\"scale\":2,\"label\":\"Won Sales 12M (USD)\",\"type\":\"NUMBER\"}]}},\"FORMULA20\":{\"sources\":[\"FORMULA19\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" < (to_unix_timestamp(now()) - 86400 * 365)\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= (to_unix_timestamp(now()) - 86400 * 730)\\r\\n\\tthen \\\"ASD.Sales\\\"\\r\\n\\telse 0\\r\\nend\\r\\n\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_SalesPR12\",\"scale\":2,\"label\":\"Sales PR12\",\"type\":\"NUMBER\"}]}},\"FORMULA21\":{\"sources\":[\"FORMULA20\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" < (to_unix_timestamp(now()) - 86400 * 365)\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= (to_unix_timestamp(now()) - 86400 * 730)\\r\\n\\tthen \\\"ASD.Sales_USD\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_SalesPR12_USD\",\"scale\":2,\"label\":\"Sales PR12 (USD)\",\"type\":\"NUMBER\"}]}},\"FORMULA22\":{\"sources\":[\"FORMULA21\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= to_unix_timestamp(now())\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= (to_unix_timestamp(now()) - 86400 * 365)\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_QuantityR12\",\"scale\":0,\"label\":\"Quantity R12\",\"type\":\"NUMBER\"}]}},\"FORMULA23\":{\"sources\":[\"FORMULA22\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" < (to_unix_timestamp(now()) - 86400 * 365)\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= (to_unix_timestamp(now()) - 86400 * 730)\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_QuantityPR12\",\"scale\":0,\"label\":\"Quantity PR12\",\"type\":\"NUMBER\"}]}},\"FILTER2_copy0_copy1\":{\"sources\":[\"AGGREGATE5\"],\"action\":\"sqlFilter\",\"parameters\":{\"sqlFilterExpression\":\"SUM_BuyRangeQty >= 10\"}},\"FILTER2_copy0_copy0\":{\"sources\":[\"AGGREGATE5\"],\"action\":\"sqlFilter\",\"parameters\":{\"sqlFilterExpression\":\"SUM_ActiveRangeQty = 0 and LostQuantity12M > 0\"}},\"FILTER1_copy0\":{\"sources\":[\"FILTER1\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[\"II11\"],\"field\":\"Product2Sales.Global.PG2_Code__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"},{\"operands\":[\"IR3511\",\"IR3521\",\"IR3522\"],\"field\":\"Product2Sales.Global.PG4_Code__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"},{\"operands\":[\"1\"],\"field\":\"time.isCR12\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"}],\"filterBooleanLogic\":\"(1 OR 2) AND 3\"}},\"EXTRACT0_copy0\":{\"sources\":[\"FORMULA0_copy0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT9\":{\"sources\":[\"DROP_FIELDS4\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[{\"source\":\"Invoice_Date__c\",\"targets\":[{\"name\":\"Invoice_Date__c_YEAR\",\"label\":\"Invoice Date Year\",\"grainType\":\"YEAR\"}]}]}},\"EXTRACT7\":{\"sources\":[\"AGGREGATE1\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT8\":{\"sources\":[\"FILTER1_copy0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT5\":{\"sources\":[\"FILTER2_copy0_copy1\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT6\":{\"sources\":[\"APPEND1\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT3\":{\"sources\":[\"FILTER2_copy0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT4\":{\"sources\":[\"FILTER2_copy0_copy0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT1\":{\"sources\":[\"FORMULA35\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[{\"source\":\"Invoice_Date__c\",\"targets\":[{\"name\":\"Invoice_Date__c_MONTH\",\"label\":\"Invoice_Date__c Month\",\"grainType\":\"MONTH\"},{\"name\":\"Invoice_Date__c_YEAR\",\"label\":\"Invoice_Date__c Year\",\"grainType\":\"YEAR\"}]}]}},\"EXTRACT2\":{\"sources\":[\"FILTER4\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"FORMULA13\":{\"sources\":[\"FORMULA0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(0)\",\"defaultValue\":\"string(0)\",\"precision\":1,\"name\":\"JoinHelper\",\"label\":\"JoinHelper\",\"type\":\"TEXT\"}]}},\"FORMULA6\":{\"sources\":[\"FORMULA4\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 12 months ago. This is going to define the range in which customers have to keep buying to be considered to be an active customer.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 12)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 12)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 11)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 11)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ActiveRange_Date\",\"scale\":0,\"label\":\"ActiveRange_Date\",\"type\":\"NUMBER\"}]}},\"FORMULA7\":{\"sources\":[\"FORMULA6\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 12 months ago. This is going to define the range in which customers have to keep buying to be considered to be an active customer.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 12)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 12)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 12)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 11)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"name\":\"ActiveRange_Helper\",\"format\":\"yyyy-MM-dd\",\"label\":\"ActiveRange_Helper\",\"type\":\"DATETIME\"}]}},\"FORMULA14\":{\"sources\":[\"FORMULA8\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\\"Product2Sales.Global.SBU_Name__c\\\"\\r\\n\\twhen 'TEST' then 'TEST'\\r\\n\\telse\\r\\n\\t\\\"Product2Sales.Global.SBU_Name__c\\\"\\r\\nend\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"TargetSegment\",\"label\":\"TargetSegment\",\"type\":\"TEXT\"}]}},\"FORMULA8\":{\"sources\":[\"FILTER1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"to_unix_timestamp(Invoice_Date__c)\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Invoice_Date_sec_epoch\",\"scale\":0,\"label\":\"Invoice_Date_sec_epoch\",\"type\":\"NUMBER\"}]}},\"FORMULA15\":{\"sources\":[\"FORMULA5\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 24 months ago. This is going to define the range to calculate the turnover in the PR12 of each month.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 24)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 24)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 23)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 23)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"LostSalesRange_Date\",\"scale\":0,\"label\":\"LostSalesRange_Date\",\"type\":\"NUMBER\"}]}},\"FORMULA16\":{\"sources\":[\"FORMULA15\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 24 months ago. This is going to define the range to calculate the turnover in the PR12 of each month.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 24)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 24)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 23)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 23)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"name\":\"LostSalesRange_Helper\",\"format\":\"yyyy-MM-dd\",\"label\":\"LostSalesRange_Helper\",\"type\":\"DATETIME\"}]}},\"FORMULA9\":{\"sources\":[\"JOIN1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= \\\"Calendar.MonthEnd\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.BuyRange_Date\\\"\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"BuyRangeQty\",\"scale\":0,\"label\":\"BuyRangeQty\",\"type\":\"NUMBER\"}]}},\"DROP_FIELDS0\":{\"sources\":[\"FORMULA26\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"ActiveRange_Helper\",\"BuyRange_Helper\",\"NoBuyRange_Helper\",\"JoinHelper\",\"CutOffMonth.JoinHelper\",\"LostSalesRange_Helper\",\"CutOffMonthEnd_Helper\",\"WonSalesRange_Helper\",\"Year\",\"Month\"]},\"fields\":[]}},\"FORMULA17\":{\"sources\":[\"FORMULA11\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= to_unix_timestamp(now())\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= (to_unix_timestamp(now()) - 86400 * 365)\\r\\n\\tthen \\\"ASD.Sales\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_SalesR12\",\"scale\":2,\"label\":\"Sales R12\",\"type\":\"NUMBER\"}]}},\"FORMULA18\":{\"sources\":[\"EDIT_ATTRIBUTES4\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"to_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(CutOffMonthEnd_Date))), '-',string(month(from_unixtime(CutOffMonthEnd_Date))), '-', string(day(from_unixtime(CutOffMonthEnd_Date)))), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\",\"defaultValue\":\"\",\"name\":\"CutOffMonthEnd_Helper\",\"format\":\"yyyy-MM-dd\",\"label\":\"CutOffMonthEnd_Helper\",\"type\":\"DATETIME\"}]}},\"EXTRACT10\":{\"sources\":[\"EXTRACT9\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[{\"source\":\"Invoice_Date__c\",\"targets\":[{\"name\":\"Invoice_Date__c_MONTH\",\"label\":\"Invoice Date Month\",\"grainType\":\"MONTH\"}]}]}},\"FORMULA19\":{\"sources\":[\"FORMULA17\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= to_unix_timestamp(now())\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= (to_unix_timestamp(now()) - 86400 * 365)\\r\\n\\tthen \\\"ASD.Sales_USD\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ASD_SalesR12_USD\",\"scale\":2,\"label\":\"Sales R12 (USD)\",\"type\":\"NUMBER\"}]}},\"DROP_FIELDS4\":{\"sources\":[\"FORMULA14\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"time.isCR12\"]},\"fields\":[]}},\"DROP_FIELDS3\":{\"sources\":[\"JOIN5\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"MIN_Calendar.CutOffMonthEnd\",\"Stats.FirstLoss\",\"Stats.FirstWin\",\"Stats.FirstBuyQty\",\"Stats.LastBuyQty\",\"Stats.ASD.ac.OneSF_Id__c\",\"Stats.ASD.Product2Sales.Global.Brand__c\",\"Stats.ASD.TargetSegment\",\"MAX_Calendar.MonthEnd\",\"ASD.ac.OneSF_Id__c\"]},\"fields\":[]}},\"DROP_FIELDS1\":{\"sources\":[\"FILTER3\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"MAX_InvoiceDate_sec_epoch\"]},\"fields\":[]}},\"FORMULA10\":{\"sources\":[\"FORMULA9\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= \\\"Calendar.MonthEnd\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.ActiveRange_Date\\\"\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"ActiveRangeQty\",\"scale\":0,\"label\":\"ActiveRangeQty\",\"type\":\"NUMBER\"}]}},\"FORMULA11\":{\"sources\":[\"FORMULA10\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case \\r\\n\\twhen \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" <= \\\"Calendar.BuyRange_Date\\\"\\r\\n    and \\\"ASD.MAX_Invoice_Date_sec_epoch\\\" >= \\\"Calendar.NoBuyRange_Date\\\"\\r\\n\\tthen \\\"ASD.Quantity\\\"\\r\\n\\telse 0\\r\\nend\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"NoBuyRangeQty\",\"scale\":0,\"label\":\"NoBuyRangeQty\",\"type\":\"NUMBER\"}]}},\"DROP_FIELDS6\":{\"sources\":[\"FORMULA34\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"WonBrands.Product2Sales.Global.Brand__c\"]},\"fields\":[]}},\"FORMULA12\":{\"sources\":[\"JOIN2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when \\\"MAX_Calendar.MonthEnd\\\" = \\\"Stats.FirstWin\\\" AND \\\"MAX_Calendar.MonthEnd\\\" = \\\"Stats.FirstBuyQty\\\"\\r\\n\\tthen 'Won'\\r\\n\\telse\\r\\n    case when \\\"MAX_Calendar.MonthEnd\\\" = \\\"Stats.FirstLoss\\\" AND \\\"Stats.FirstLoss\\\" >= \\\"Stats.LastBuyQty\\\"\\r\\n        then 'Lost'\\r\\n        else null\\r\\n\\tend\\r\\nend\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"Activity\",\"label\":\"Activity\",\"type\":\"TEXT\"}]}},\"DROP_FIELDS5\":{\"sources\":[\"FORMULA35\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"SELECT\",\"ignoreMissingFields\":true,\"fields\":[\"YearMonth\",\"Product2Sales.Global.Brand__c\",\"ac.OneSF_Id__c\"]},\"fields\":[]}},\"FILTER2_copy0\":{\"sources\":[\"AGGREGATE5\"],\"action\":\"sqlFilter\",\"parameters\":{\"sqlFilterExpression\":\"SUM_BuyRangeQty >= 10 and SUM_NoBuyRangeQty = 0\"}},\"APPEND0\":{\"sources\":[\"AGGREGATE9\",\"AGGREGATE11\"],\"action\":\"appendV2\",\"parameters\":{\"fieldMappings\":[{\"top\":\"ASD.ac.OneSF_Id__c\",\"bottom\":\"ASD.ac.OneSF_Id__c\"},{\"top\":\"ASD.TargetSegment\",\"bottom\":\"ASD.TargetSegment\"},{\"bottom\":\"LastBuyQty_1\"},{\"bottom\":\"FirstBuyQty_1\"}]}},\"APPEND1\":{\"sources\":[\"AGGREGATE7\",\"APPEND0\"],\"action\":\"appendV2\",\"parameters\":{\"fieldMappings\":[{\"top\":\"ASD.ac.OneSF_Id__c\",\"bottom\":\"ASD.ac.OneSF_Id__c\"},{\"top\":\"ASD.TargetSegment\",\"bottom\":\"ASD.TargetSegment\"},{\"bottom\":\"FirstLoss_1\"},{\"bottom\":\"LastBuyQty_1\"},{\"bottom\":\"FirstBuyQty_1\"}]}},\"FORMULA0\":{\"sources\":[\"FILTER0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"to_unix_timestamp(Today) + 86399\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Date_sec_epoch\",\"scale\":0,\"label\":\"Date_sec_epoch\",\"type\":\"NUMBER\"}]}},\"SPLIT0\":{\"sources\":[\"DROP_FIELDS3\"],\"action\":\"split\",\"parameters\":{\"sourceField\":\"Calendar.YearMonth\",\"delimiter\":\"-\",\"targetFields\":[{\"name\":\"Calendar.YearMonth_split\",\"label\":\"Year\"},{\"name\":\"Calendar.YearMonth_split1\",\"label\":\"Month\"}]}},\"FORMULA2\":{\"sources\":[\"JOIN3\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 5 months ago. This is going to define the range in which customers are allowed to buy the needed quantity to be considered as new.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 6)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 6)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 5)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 5)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"BuyRange_Date\",\"scale\":0,\"label\":\"BuyRange_Date\",\"type\":\"NUMBER\"}]}},\"FORMULA3\":{\"sources\":[\"FORMULA7\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 18 months ago. This is going to define the range in which customers are not allowed to buy a product to be considered as new.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 18)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 18)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 17)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 17)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"NoBuyRange_Date\",\"scale\":0,\"label\":\"NoBuyRange_Date\",\"type\":\"NUMBER\"}]}},\"FORMULA4\":{\"sources\":[\"FORMULA2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 5 months ago. This is going to define the range in which customers are allowed to buy the needed quantity to be considered as new.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 6)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 6)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 5)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 5)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"name\":\"BuyRange_Helper\",\"format\":\"yyyy-MM-dd\",\"label\":\"BuyRange_Helper\",\"type\":\"DATETIME\"}]}},\"FORMULA5\":{\"sources\":[\"FORMULA3\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"/*We are calculating the first day of the month 18 months ago. This is going to define the range in which customers are not allowed to buy a product to be considered as new.*/\\r\\n\\r\\ncase when year(now()) = year(from_unixtime(MAX_Date_sec_epoch)) and month(now()) = month(from_unixtime(MAX_Date_sec_epoch))\\r\\n\\r\\nthen \\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 18)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 18)))), '-', day(now())), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nelse\\r\\n\\r\\nto_timestamp(from_unixtime(\\r\\n\\r\\nto_unix_timestamp(concat(string(year(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 17)))), '-',string(month(from_unixtime(MAX_Date_sec_epoch - (86400 * 31 * 17)))), '-01'), 'yyyy-MM-dd')\\r\\n\\r\\n), 'yyyy-MM-dd')\\r\\n\\r\\nend\",\"defaultValue\":\"\",\"name\":\"NoBuyRange_Helper\",\"format\":\"yyyy-MM-dd\",\"label\":\"NoBuyRange_Helper\",\"type\":\"DATETIME\"}]}},\"AGGREGATE7\":{\"sources\":[\"EXTRACT3\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"FirstWin_1\",\"action\":\"MIN\",\"source\":\"MAX_Calendar.MonthEnd\",\"label\":\"FirstWin\"}]}},\"FILTER4\":{\"sources\":[\"FORMULA32\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[],\"field\":\"ASD.ac.OneSF_Id__c\",\"type\":\"TEXT\",\"operator\":\"IS_NOT_NULL\"}]}},\"AGGREGATE9\":{\"sources\":[\"EXTRACT4\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"FirstLoss_1\",\"action\":\"MIN\",\"source\":\"MAX_Calendar.MonthEnd\",\"label\":\"FirstLoss\"}]}},\"FILTER0\":{\"sources\":[\"LOAD_DATASET1\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":-18,\"type\":\"N_MONTHS\"},{\"argument\":0,\"type\":\"N_MONTHS\"}],\"field\":\"Today\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"FILTER1\":{\"sources\":[\"LOAD_DATASET0\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":-36,\"type\":\"N_MONTHS\"},{\"argument\":0,\"type\":\"N_MONTHS\"}],\"field\":\"Invoice_Date__c\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"},{\"operands\":[\"II11\"],\"field\":\"Product2Sales.Global.PG2_Code__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"},{\"operands\":[\"IR3511\",\"IR3521\",\"IR3522\"],\"field\":\"Product2Sales.Global.PG4_Code__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"}],\"filterBooleanLogic\":\"1 AND (2 OR 3)\"}},\"FILTER2\":{\"sources\":[\"FORMULA12\"],\"action\":\"sqlFilter\",\"parameters\":{\"sqlFilterExpression\":\"\\\"MAX_Calendar.MonthEnd\\\" != \\\"MIN_Calendar.CutOffMonthEnd\\\"\\r\\n/* Last report month is removed with this filter to prevent the old \\\"Wons\\\" are counted in the first month */\\r\\n\\r\\n\\r\\nAND (Activity is not null)\\r\\n\\r\\n/*Only show activities*/\"}},\"FILTER3\":{\"sources\":[\"JOIN0\"],\"action\":\"sqlFilter\",\"parameters\":{\"sqlFilterExpression\":\"MAX_InvoiceDate_sec_epoch >= \\\"Calendar.NoBuyRange_Date\\\"\"}},\"AGGREGATE1\":{\"sources\":[\"EXTRACT0\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"Year\",\"Month\",\"JoinHelper\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"MAX_Date_sec_epoch\",\"action\":\"MAX\",\"source\":\"Date_sec_epoch\",\"label\":\"Maximum Date_sec_epoch\"}]}},\"AGGREGATE3\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"Sales\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"Sales_USD\"}]},\"sources\":[\"EXTRACT1\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"Invoice_Date__c_MONTH\",\"Invoice_Date__c_YEAR\",\"ac.Id\",\"ac.OneSF_Id__c\",\"TargetSegment\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"Quantity\",\"action\":\"SUM\",\"source\":\"Quantity__c\",\"label\":\"Quantity\"},{\"name\":\"Sales\",\"action\":\"SUM\",\"source\":\"Total_Value__c\",\"label\":\"Sales\"},{\"name\":\"MAX_Invoice_Date_sec_epoch\",\"action\":\"MAX\",\"source\":\"Invoice_Date_sec_epoch\",\"label\":\"MAX_Invoice_Date_sec_epoch\"},{\"name\":\"Sales_USD\",\"action\":\"SUM\",\"source\":\"Total_Price_USD\",\"label\":\"Sales USD\"}]}},\"AGGREGATE5\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":10,\"scale\":0,\"type\":\"NUMBER\"}},\"name\":\"SUM_BuyRangeQty\"},{\"newProperties\":{\"typeProperties\":{\"precision\":10,\"scale\":0,\"type\":\"NUMBER\"}},\"name\":\"SUM_ActiveRangeQty\"},{\"newProperties\":{\"typeProperties\":{\"precision\":10,\"scale\":0,\"type\":\"NUMBER\"}},\"name\":\"SUM_NoBuyRangeQty\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SalesR12\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SalesR12_USD\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SalesPR12\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SalesPR12_USD\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"LostSales12M\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"LostSales12M_USD\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"WonSales12M\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"WonSales12M_USD\"}]},\"sources\":[\"EXTRACT2\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\",\"Calendar.YearMonth\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"SUM_BuyRangeQty\",\"action\":\"SUM\",\"source\":\"BuyRangeQty\",\"label\":\"BuyRangeQty\"},{\"name\":\"SUM_ActiveRangeQty\",\"action\":\"SUM\",\"source\":\"ActiveRangeQty\",\"label\":\"ActiveRangeQty\"},{\"name\":\"SUM_NoBuyRangeQty\",\"action\":\"SUM\",\"source\":\"NoBuyRangeQty\",\"label\":\"NoBuyRangeQty\"},{\"name\":\"MAX_Calendar.MonthEnd\",\"action\":\"MAX\",\"source\":\"Calendar.MonthEnd\",\"label\":\"MonthEnd\"},{\"name\":\"MIN_Calendar.CutOffMonthEnd\",\"action\":\"MIN\",\"source\":\"Calendar.CutOffMonthEnd_Date\",\"label\":\"CutOffMonthEnd\"},{\"name\":\"SalesR12\",\"action\":\"SUM\",\"source\":\"ASD_SalesR12\",\"label\":\"Sales R12\"},{\"name\":\"SalesR12_USD\",\"action\":\"SUM\",\"source\":\"ASD_SalesR12_USD\",\"label\":\"Sales R12 (USD)\"},{\"name\":\"SalesPR12\",\"action\":\"SUM\",\"source\":\"ASD_SalesPR12\",\"label\":\"Sales PR12\"},{\"name\":\"SalesPR12_USD\",\"action\":\"SUM\",\"source\":\"ASD_SalesPR12_USD\",\"label\":\"Sales PR12 (USD)\"},{\"name\":\"QuantityR12\",\"action\":\"SUM\",\"source\":\"ASD_QuantityR12\",\"label\":\"Quantity R12\"},{\"name\":\"QuantityPR12\",\"action\":\"SUM\",\"source\":\"ASD_QuantityPR12\",\"label\":\"Quantity PR12\"},{\"name\":\"LostQuantity12M\",\"action\":\"SUM\",\"source\":\"ASD_LostQuantity12M\",\"label\":\"Lost Quantity 12M\"},{\"name\":\"LostSales12M\",\"action\":\"SUM\",\"source\":\"ASD_LostSales12M\",\"label\":\"Lost Sales 12M\"},{\"name\":\"LostSales12M_USD\",\"action\":\"SUM\",\"source\":\"ASD_LostSales12M_USD\",\"label\":\"Lost Sales 12M (USD)\"},{\"name\":\"WonQuantity12M\",\"action\":\"SUM\",\"source\":\"ASD_WonQuantity12M\",\"label\":\"Won Quantity 12M\"},{\"name\":\"WonSales12M\",\"action\":\"SUM\",\"source\":\"ASD_WonSales12M\",\"label\":\"Won Sales 12M\"},{\"name\":\"WonSales12M_USD\",\"action\":\"SUM\",\"source\":\"ASD_WonSales12M_USD\",\"label\":\"Won Sales 12M (USD)\"}]}},\"FILTER0_copy0\":{\"sources\":[\"LOAD_DATASET1\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":-36,\"type\":\"N_MONTHS\"},{\"argument\":0,\"type\":\"N_MONTHS\"}],\"field\":\"Today\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"JOIN1\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"DROP_FIELDS1\",\"AGGREGATE3\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"InvoiceYear\",\"InvoiceMonth\"],\"rightQualifier\":\"ASD\",\"rightKeys\":[\"Invoice_Date__c_YEAR\",\"Invoice_Date__c_MONTH\"],\"joinType\":\"LEFT_OUTER\"}},\"JOIN0\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]}},\"sources\":[\"EDIT_ATTRIBUTES3\",\"DROP_FIELDS0\"],\"action\":\"join\",\"parameters\":{\"rightQualifier\":\"Calendar\",\"joinType\":\"CROSS\"}},\"AGGREGATE17\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"ImplantSalesR12\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"ImplantSalesR12_USD\"}]},\"sources\":[\"EXTRACT8\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"ac.OneSF_Id__c\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"ImplantQuantityR12\",\"action\":\"SUM\",\"source\":\"Quantity__c\",\"label\":\"Implant Quantity R12\"},{\"name\":\"ImplantSalesR12\",\"action\":\"SUM\",\"source\":\"Total_Value__c\",\"label\":\"Implant Sales R12\"},{\"name\":\"ImplantSalesR12_USD\",\"action\":\"SUM\",\"source\":\"Total_Price_USD\",\"label\":\"Implant Sales R12 (USD)\"}]}},\"JOIN7\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"WonBrands.ac.OneSF_Id__c\",\"WonBrands.YearMonth\"]},\"fields\":[]},\"sources\":[\"JOIN4\",\"DROP_FIELDS5\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Account.OneSF_Id__c\",\"Calendar.YearMonth\"],\"rightQualifier\":\"WonBrands\",\"rightKeys\":[\"ac.OneSF_Id__c\",\"YearMonth\"],\"joinType\":\"MULTI_VALUE_LOOKUP\"}},\"JOIN5\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"ImplantAgg.ac.OneSF_Id__c\"]},\"fields\":[]},\"sources\":[\"DROP_FIELDS6\",\"AGGREGATE17\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Account.OneSF_Id__c\"],\"rightQualifier\":\"ImplantAgg\",\"rightKeys\":[\"ac.OneSF_Id__c\"],\"joinType\":\"LOOKUP\"}},\"AGGREGATE13\":{\"sources\":[\"EXTRACT6\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"FirstLoss\",\"action\":\"MAX\",\"source\":\"FirstLoss_1\",\"label\":\"FirstLoss\"},{\"name\":\"FirstWin\",\"action\":\"MAX\",\"source\":\"FirstWin_1\",\"label\":\"FirstWin\"},{\"name\":\"LastBuyQty\",\"action\":\"MAX\",\"source\":\"LastBuyQty_1\",\"label\":\"LastBuyQty\"},{\"name\":\"FirstBuyQty\",\"action\":\"MAX\",\"source\":\"FirstBuyQty_1\",\"label\":\"FirstBuyQty\"}]}},\"JOIN4\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"ASD.ac.OneSF_Id__c\"]},\"fields\":[]},\"sources\":[\"FILTER2\",\"LOAD_DATASET3\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"ASD.ac.OneSF_Id__c\"],\"rightQualifier\":\"Account\",\"rightKeys\":[\"OneSF_Id__c\"],\"joinType\":\"LOOKUP\"}},\"JOIN3\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"AGGREGATE1\",\"AGGREGATE15\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"JoinHelper\"],\"rightQualifier\":\"CutOffMonth\",\"rightKeys\":[\"JoinHelper\"],\"joinType\":\"LOOKUP\"}},\"JOIN2\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Stats.ASD.ac.OneSF_Id__c\",\"Stats.ASD.TargetSegment\"]},\"fields\":[]},\"sources\":[\"AGGREGATE5\",\"AGGREGATE13\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\"],\"rightQualifier\":\"Stats\",\"rightKeys\":[\"ASD.ac.OneSF_Id__c\",\"ASD.TargetSegment\"],\"joinType\":\"LOOKUP\"}},\"AGGREGATE15\":{\"sources\":[\"EXTRACT7\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"JoinHelper\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"MIN_MAX_Date_sec_epoch\",\"action\":\"MIN\",\"source\":\"MAX_Date_sec_epoch\",\"label\":\"Minimum Maximum Date_sec_epoch\"}]}}},\"ui\":{\"hiddenColumns\":[],\"connectors\":[{\"source\":\"TRANSFORM8\",\"target\":\"JOIN5\"},{\"source\":\"AGGREGATE8\",\"target\":\"APPEND0\"},{\"source\":\"AGGREGATE6\",\"target\":\"APPEND1\"},{\"source\":\"LOAD_DATASET1\",\"target\":\"FILTER0\"},{\"source\":\"FILTER0\",\"target\":\"TRANSFORM0\"},{\"source\":\"TRANSFORM0\",\"target\":\"AGGREGATE0\"},{\"source\":\"LOAD_DATASET0\",\"target\":\"FILTER1\"},{\"source\":\"FILTER1\",\"target\":\"TRANSFORM1\"},{\"source\":\"FILTER4\",\"target\":\"AGGREGATE4\"},{\"source\":\"TRANSFORM7\",\"target\":\"OUTPUT0\"},{\"source\":\"LOAD_DATASET1\",\"target\":\"FILTER0_copy0\"},{\"source\":\"AGGREGATE0_copy0\",\"target\":\"TRANSFORM2_copy0\"},{\"source\":\"FILTER0_copy0\",\"target\":\"TRANSFORM0_copy0\"},{\"source\":\"TRANSFORM0_copy0\",\"target\":\"AGGREGATE0_copy0\"},{\"source\":\"TRANSFORM2_copy0\",\"target\":\"JOIN0\"},{\"source\":\"TRANSFORM2\",\"target\":\"JOIN0\"},{\"source\":\"JOIN0\",\"target\":\"FILTER3\"},{\"source\":\"FILTER3\",\"target\":\"TRANSFORM4\"},{\"source\":\"TRANSFORM4\",\"target\":\"JOIN1\"},{\"source\":\"JOIN1\",\"target\":\"TRANSFORM3\"},{\"source\":\"AGGREGATE4\",\"target\":\"FILTER2_copy0\"},{\"source\":\"FILTER2_copy0\",\"target\":\"AGGREGATE6\"},{\"source\":\"AGGREGATE4\",\"target\":\"JOIN2\"},{\"source\":\"TRANSFORM5\",\"target\":\"FILTER2\"},{\"source\":\"JOIN2\",\"target\":\"TRANSFORM5\"},{\"source\":\"AGGREGATE4\",\"target\":\"FILTER2_copy0_copy0\"},{\"source\":\"FILTER2_copy0_copy0\",\"target\":\"AGGREGATE8\"},{\"source\":\"AGGREGATE4\",\"target\":\"FILTER2_copy0_copy1\"},{\"source\":\"FILTER2_copy0_copy1\",\"target\":\"AGGREGATE10\"},{\"source\":\"APPEND0\",\"target\":\"APPEND1\"},{\"source\":\"APPEND1\",\"target\":\"AGGREGATE12\"},{\"source\":\"AGGREGATE12\",\"target\":\"JOIN2\"},{\"source\":\"AGGREGATE10\",\"target\":\"APPEND0\"},{\"source\":\"TRANSFORM3\",\"target\":\"FILTER4\"},{\"source\":\"AGGREGATE0\",\"target\":\"AGGREGATE14\"},{\"source\":\"AGGREGATE0\",\"target\":\"JOIN3\"},{\"source\":\"AGGREGATE14\",\"target\":\"JOIN3\"},{\"source\":\"JOIN3\",\"target\":\"TRANSFORM2\"},{\"source\":\"JOIN5\",\"target\":\"TRANSFORM7\"},{\"source\":\"FILTER2\",\"target\":\"JOIN4\"},{\"source\":\"TRANSFORM1\",\"target\":\"TRANSFORM6\"},{\"source\":\"TRANSFORM6\",\"target\":\"AGGREGATE2\"},{\"source\":\"FILTER1\",\"target\":\"FILTER1_copy0\"},{\"source\":\"FILTER1_copy0\",\"target\":\"AGGREGATE16\"},{\"source\":\"AGGREGATE16\",\"target\":\"JOIN5\"},{\"source\":\"TRANSFORM6\",\"target\":\"TRANSFORM9\"},{\"source\":\"JOIN4\",\"target\":\"JOIN7\"},{\"source\":\"TRANSFORM9\",\"target\":\"JOIN7\"},{\"source\":\"AGGREGATE2\",\"target\":\"JOIN1\"},{\"source\":\"JOIN7\",\"target\":\"TRANSFORM8\"},{\"source\":\"LOAD_DATASET3\",\"target\":\"JOIN4\"}],\"nodes\":{\"TRANSFORM0_copy0\":{\"connectors\":[],\"top\":112.1,\"left\":392,\"description\":\"Creating the unix timestamp for the Invoice Date.\",\"label\":\"Sec Epoch (ID)\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA0_copy0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"AGGREGATE10\":{\"connectors\":[{\"source\":\"EXTRACT5\",\"target\":\"AGGREGATE11\"}],\"top\":532.2,\"left\":1932.2,\"description\":\"\",\"label\":\"Last Buy\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE11\":null,\"EXTRACT5\":null}},\"TRANSFORM2_copy0\":{\"connectors\":[{\"source\":\"EDIT_ATTRIBUTES1\",\"target\":\"EDIT_ATTRIBUTES2\"},{\"source\":\"EDIT_ATTRIBUTES2\",\"target\":\"EDIT_ATTRIBUTES3\"}],\"top\":112.1,\"left\":672,\"description\":\"\",\"label\":\"Clean Up (ID)\",\"type\":\"TRANSFORM\",\"graph\":{\"EDIT_ATTRIBUTES1\":{\"label\":\"Edit Attributes\"},\"EDIT_ATTRIBUTES3\":{\"label\":\"Edit Attributes\"},\"EDIT_ATTRIBUTES2\":{\"label\":\"Edit Attributes\"}}},\"TRANSFORM4\":{\"connectors\":[],\"top\":112.1,\"left\":1092,\"description\":\"\",\"label\":\"Clean Up (Cross)\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS1\":{\"label\":\"Drop Columns\"}}},\"FILTER2_copy0\":{\"top\":252.2,\"left\":1792,\"description\":\"\",\"label\":\"Won?\",\"type\":\"FILTER\"},\"TRANSFORM5\":{\"connectors\":[],\"top\":112.19999999999999,\"left\":2352,\"description\":\"\",\"label\":\"Won/Lost Flags\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA12\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"OUTPUT0\":{\"top\":112.30000000000001,\"left\":3332.9,\"label\":\"Output 0\",\"type\":\"OUTPUT\"},\"TRANSFORM6\":{\"connectors\":[{\"source\":\"FORMULA14\",\"target\":\"DROP_FIELDS4\"},{\"source\":\"DROP_FIELDS4\",\"target\":\"EXTRACT9\"},{\"source\":\"EXTRACT9\",\"target\":\"EXTRACT10\"},{\"source\":\"EXTRACT10\",\"target\":\"FORMULA35\"}],\"top\":532.4,\"left\":532.1,\"description\":\"\",\"label\":\"Target Segment\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA35\":{\"label\":\"YearMonth\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA14\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"EXTRACT10\":{\"label\":\"Extract Date Component\"},\"EXTRACT9\":{\"label\":\"Extract Date Component\"},\"DROP_FIELDS4\":{\"label\":\"Drop Columns\"}}},\"TRANSFORM7\":{\"connectors\":[{\"source\":\"DROP_FIELDS3\",\"target\":\"SPLIT0\"},{\"source\":\"SPLIT0\",\"target\":\"EDIT_ATTRIBUTES5\"},{\"source\":\"EDIT_ATTRIBUTES5\",\"target\":\"EDIT_ATTRIBUTES6\"},{\"source\":\"EDIT_ATTRIBUTES6\",\"target\":\"FORMULA33\"}],\"top\":112.30000000000001,\"left\":3192.9,\"description\":\"\",\"label\":\"Cleanup\",\"type\":\"TRANSFORM\",\"graph\":{\"EDIT_ATTRIBUTES5\":{\"label\":\"Edit Attributes\"},\"EDIT_ATTRIBUTES6\":{\"label\":\"Edit Attributes\"},\"DROP_FIELDS3\":{\"label\":\"Drop Columns\"},\"SPLIT0\":{\"label\":\"Split\"},\"FORMULA33\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"LOAD_DATASET3\":{\"top\":391.9,\"left\":2632.3,\"label\":\"Accounts\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":10000}},\"TRANSFORM8\":{\"connectors\":[{\"source\":\"FORMULA34\",\"target\":\"DROP_FIELDS6\"}],\"top\":112.5,\"left\":2912,\"label\":\"Transform 8\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS6\":{\"label\":\"Drop Columns\"},\"FORMULA34\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"LOAD_DATASET1\":{\"top\":112.19999999999999,\"left\":112,\"label\":\"Calendar\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":10000}},\"TRANSFORM9\":{\"connectors\":[],\"top\":672,\"left\":532,\"description\":\"\",\"label\":\"WonBrands\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS5\":{\"label\":\"Keep Columns\"}}},\"LOAD_DATASET0\":{\"top\":532.7,\"left\":112.1,\"label\":\"Account Sales Detail - v2\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":10000}},\"APPEND0\":{\"top\":392.1,\"left\":2072.1,\"label\":\"Append 0\",\"type\":\"APPEND\"},\"APPEND1\":{\"top\":252.10000000000002,\"left\":2072,\"label\":\"Append 1\",\"type\":\"APPEND\"},\"TRANSFORM0\":{\"connectors\":[{\"source\":\"FORMULA0\",\"target\":\"FORMULA13\"}],\"top\":252.39999999999998,\"left\":392.1,\"description\":\"Creating the unix timestamp for the Report Date\",\"label\":\"Sec Epoch (RD)\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA13\":{\"label\":\"JoinHelper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM1\":{\"connectors\":[],\"top\":532.7,\"left\":392.1,\"description\":\"\",\"label\":\"Sec Epoch (Sales)\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA8\":{\"label\":\"Invoice_Date_sec_epoch\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM2\":{\"connectors\":[{\"source\":\"FORMULA2\",\"target\":\"FORMULA4\"},{\"source\":\"FORMULA3\",\"target\":\"FORMULA5\"},{\"source\":\"FORMULA4\",\"target\":\"FORMULA6\"},{\"source\":\"FORMULA7\",\"target\":\"FORMULA3\"},{\"source\":\"FORMULA6\",\"target\":\"FORMULA7\"},{\"source\":\"EDIT_ATTRIBUTES0\",\"target\":\"EDIT_ATTRIBUTES4\"},{\"source\":\"FORMULA5\",\"target\":\"FORMULA15\"},{\"source\":\"FORMULA15\",\"target\":\"FORMULA16\"},{\"source\":\"EDIT_ATTRIBUTES4\",\"target\":\"FORMULA18\"},{\"source\":\"FORMULA16\",\"target\":\"FORMULA24\"},{\"source\":\"FORMULA25\",\"target\":\"EDIT_ATTRIBUTES0\"},{\"source\":\"FORMULA24\",\"target\":\"FORMULA25\"},{\"source\":\"FORMULA26\",\"target\":\"DROP_FIELDS0\"},{\"source\":\"FORMULA18\",\"target\":\"FORMULA26\"}],\"top\":252.3,\"left\":812.1,\"description\":\"\",\"label\":\"Date Ranges\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA6\":{\"label\":\"ActiveRange_Date\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA24\":{\"label\":\"WonSalesRange_Date\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA7\":{\"label\":\"ActiveRange_Helper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA25\":{\"label\":\"WonSalesRange_Helper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA15\":{\"label\":\"LostSalesRange_Date\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA26\":{\"label\":\"YearMonth\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA16\":{\"label\":\"LostSalesRange_Helper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"DROP_FIELDS0\":{\"label\":\"Drop Columns\"},\"FORMULA18\":{\"label\":\"CutOffMonthEnd_Helper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"EDIT_ATTRIBUTES4\":{\"label\":\"Edit Attributes\"},\"EDIT_ATTRIBUTES0\":{\"label\":\"Edit Attributes\"},\"FORMULA2\":{\"label\":\"BuyRange_Date\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA3\":{\"label\":\"NoBuyRange_Date\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA4\":{\"label\":\"BuyRange_Helper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA5\":{\"label\":\"NoBuyRange_Helper\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM3\":{\"connectors\":[{\"source\":\"FORMULA9\",\"target\":\"FORMULA10\"},{\"source\":\"FORMULA10\",\"target\":\"FORMULA11\"},{\"source\":\"FORMULA11\",\"target\":\"FORMULA17\"},{\"source\":\"FORMULA17\",\"target\":\"FORMULA19\"},{\"source\":\"FORMULA19\",\"target\":\"FORMULA20\"},{\"source\":\"FORMULA20\",\"target\":\"FORMULA21\"},{\"source\":\"FORMULA21\",\"target\":\"FORMULA22\"},{\"source\":\"FORMULA22\",\"target\":\"FORMULA23\"},{\"source\":\"FORMULA23\",\"target\":\"FORMULA27\"},{\"source\":\"FORMULA27\",\"target\":\"FORMULA28\"},{\"source\":\"FORMULA28\",\"target\":\"FORMULA29\"},{\"source\":\"FORMULA29\",\"target\":\"FORMULA30\"},{\"source\":\"FORMULA30\",\"target\":\"FORMULA31\"},{\"source\":\"FORMULA31\",\"target\":\"FORMULA32\"}],\"top\":112.30000000000001,\"left\":1372.3,\"description\":\"Quantity is added if in Buy, Active and/or NoBuy ranges.\",\"label\":\"Qty > Range\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA9\":{\"label\":\"BuyRangeQty\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA27\":{\"label\":\"WonQuantity12M\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA17\":{\"label\":\"SalesR12\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA28\":{\"label\":\"WonSales12M\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA29\":{\"label\":\"WonSales12M_USD\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA19\":{\"label\":\"SalesR12_USD\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA30\":{\"label\":\"LostQuantity12M\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA20\":{\"label\":\"SalesPR12\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA31\":{\"label\":\"LostSales12M\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA10\":{\"label\":\"ActiveRangeQty\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA21\":{\"label\":\"SalesPR12_USD\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA32\":{\"label\":\"LostSales12M_USD\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA11\":{\"label\":\"NoBuyRangeQty\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA22\":{\"label\":\"QuantityR12\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA23\":{\"label\":\"QuantityPR12\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"FILTER4\":{\"top\":112,\"left\":1512,\"description\":\"\",\"label\":\"Clean Empty Lines\",\"type\":\"FILTER\"},\"AGGREGATE8\":{\"connectors\":[{\"source\":\"EXTRACT4\",\"target\":\"AGGREGATE9\"}],\"top\":392.2,\"left\":1932.2,\"description\":\"\",\"label\":\"First Loss\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE9\":null,\"EXTRACT4\":null}},\"FILTER0\":{\"top\":252.39999999999998,\"left\":252.10000000000002,\"description\":\"We will check the Won and Lost customers for the last 12M.\\n\\nFinally only 12M will be included in the Output but all 18M have to be checked because of the defined BuyRange of 6M.\",\"label\":\"Report Dates (18M)\",\"type\":\"FILTER\"},\"FILTER1\":{\"top\":532.7,\"left\":252.10000000000002,\"description\":\"\",\"label\":\"Sales (36M)\",\"type\":\"FILTER\"},\"FILTER2\":{\"top\":112.19999999999999,\"left\":2492,\"label\":\"Filter 2\",\"type\":\"FILTER\"},\"FILTER3\":{\"top\":112.1,\"left\":952,\"description\":\"We are removing cross joined columns that won't be needed. For every single Year-Month we will only need the last 18 months back.\\n\\nSo if the MAX_InvoiceDate_sec_epoch is smaller than NoBuyRange_Date, this isn't needed.\",\"label\":\"Out of Scope?\",\"type\":\"FILTER\"},\"AGGREGATE0\":{\"connectors\":[{\"source\":\"EXTRACT0\",\"target\":\"AGGREGATE1\"}],\"top\":252.39999999999998,\"left\":532.1,\"description\":\"\",\"label\":\"Aggregate (RD)\",\"type\":\"AGGREGATE\",\"graph\":{\"EXTRACT0\":null,\"AGGREGATE1\":null}},\"AGGREGATE0_copy0\":{\"connectors\":[{\"source\":\"EXTRACT0_copy0\",\"target\":\"AGGREGATE1_copy0\"}],\"top\":112.1,\"left\":532,\"description\":\"\",\"label\":\"Aggregate (ID)\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE1_copy0\":null,\"EXTRACT0_copy0\":null}},\"AGGREGATE2\":{\"connectors\":[{\"source\":\"EXTRACT1\",\"target\":\"AGGREGATE3\"}],\"top\":532.1,\"left\":672.1,\"description\":\"\",\"label\":\"Aggregate (Sales)\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE3\":null,\"EXTRACT1\":null}},\"AGGREGATE4\":{\"connectors\":[{\"source\":\"EXTRACT2\",\"target\":\"AGGREGATE5\"}],\"top\":112.30000000000001,\"left\":1652.8,\"label\":\"Aggregate 4\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE5\":null,\"EXTRACT2\":null}},\"FILTER0_copy0\":{\"top\":112.19999999999999,\"left\":252,\"description\":\"This are the 36M of sales data that are cross joined to the last 18M to report on.\\n\\nFinally only 12M will be included in the Output but all 18M have to be checked because of the defined BuyRange of 6M.\",\"label\":\"Invoice Dates (36M)\",\"type\":\"FILTER\"},\"AGGREGATE6\":{\"connectors\":[{\"source\":\"EXTRACT3\",\"target\":\"AGGREGATE7\"}],\"top\":252.2,\"left\":1932,\"description\":\"\",\"label\":\"First Win\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE7\":null,\"EXTRACT3\":null}},\"JOIN1\":{\"top\":112,\"left\":1232,\"description\":\"\",\"label\":\"Left Join\",\"type\":\"JOIN\"},\"FILTER2_copy0_copy1\":{\"top\":532.2,\"left\":1792.2,\"description\":\"\",\"label\":\"Rebuy?\",\"type\":\"FILTER\"},\"JOIN0\":{\"top\":112.1,\"left\":812,\"description\":\"\",\"label\":\"Cross Join\",\"type\":\"JOIN\"},\"FILTER2_copy0_copy0\":{\"top\":392.2,\"left\":1792.2,\"description\":\"\",\"label\":\"Lost?\",\"type\":\"FILTER\"},\"FILTER1_copy0\":{\"top\":672.3,\"left\":252.10000000000002,\"description\":\"\",\"label\":\"Implant CR12\",\"type\":\"FILTER\"},\"AGGREGATE16\":{\"connectors\":[{\"source\":\"EXTRACT8\",\"target\":\"AGGREGATE17\"}],\"top\":812.2,\"left\":1792.4,\"description\":\"\",\"label\":\"Aggregate (Implant Sales)\",\"type\":\"AGGREGATE\",\"graph\":{\"EXTRACT8\":null,\"AGGREGATE17\":null}},\"JOIN7\":{\"top\":112,\"left\":2772,\"label\":\"Join 7\",\"type\":\"JOIN\"},\"AGGREGATE12\":{\"connectors\":[{\"source\":\"EXTRACT6\",\"target\":\"AGGREGATE13\"}],\"top\":252.10000000000002,\"left\":2212,\"label\":\"Aggregate 12\",\"type\":\"AGGREGATE\",\"graph\":{\"EXTRACT6\":null,\"AGGREGATE13\":null}},\"JOIN5\":{\"top\":112.30000000000001,\"left\":3052.9,\"label\":\"Join 5\",\"type\":\"JOIN\"},\"JOIN4\":{\"top\":112,\"left\":2632,\"label\":\"Join 4\",\"type\":\"JOIN\"},\"AGGREGATE14\":{\"connectors\":[{\"source\":\"EXTRACT7\",\"target\":\"AGGREGATE15\"}],\"top\":392.4,\"left\":672.1,\"description\":\"We have to delete the first report month at the end to prevent wrong informations.\\n\\nOtherwise old \\\"Wons\\\" might be shown in the first month.\",\"label\":\"First Month\",\"type\":\"AGGREGATE\",\"graph\":{\"EXTRACT7\":null,\"AGGREGATE15\":null}},\"JOIN3\":{\"top\":252.39999999999998,\"left\":672.1,\"label\":\"Join 3\",\"type\":\"JOIN\"},\"JOIN2\":{\"top\":112.1,\"left\":2212,\"description\":\"\",\"label\":\"LookUp\",\"type\":\"JOIN\"}}},\"version\":\"58.0\",\"runMode\":\"full\"}"]