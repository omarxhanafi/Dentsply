["{\"nodes\":{\"Join_CaseHistory_OldOwner\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OldOwner\"],\"relationship\":\"OldOwner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CallCenterId\",\"Name\",\"Id\",\"Role.Name\",\"Type\"]},\"sources\":[\"compute_CaseHistory_OldNewStatus\",\"Join_CaseHistory_Queue_User_UserRole\"]},\"Join_CaseHistory_Case\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"CaseId\"],\"relationship\":\"Case\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"BusinessHoursId\",\"IsClosed\",\"ClosedDate\",\"CreatedDate\",\"DurationCalculatedField\",\"Complaint_Category__c\",\"Origin\",\"Complaint_Reason2__c\",\"Priority\",\"IsEscalated\",\"SLAStatus__c\",\"RecordType.Name\",\"Account.Name\",\"Account.Id\",\"CaseType__c\",\"CaseNumber\"]},\"sources\":[\"Filter_CaseHistory_OwnerNameChanges\",\"Join_CaseAccountContactUserUserRoleRecordType\"]},\"Join_ServiceCaseServiceTask\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"relationship\":\"Task\",\"rightKey\":[\"WhatId\"],\"rightSelect\":[\"ActivityLastModifiedDate\"]},\"sources\":[\"Join_CaseAccount\",\"Compute_Extract_Task\"]},\"Join_CaseAccount\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"relationship\":\"Account\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"Name\",\"BillingState\",\"Industry\"]},\"sources\":[\"Compute_CaseBusinessHours\",\"Extract_Account\"]},\"Extract_Contact\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"}],\"object\":\"Contact\"}},\"Extract_Opportunity\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"AccountId\"},{\"name\":\"OwnerId\"},{\"name\":\"Name\"},{\"defaultValue\":\"N/A\",\"name\":\"StageName\"},{\"defaultValue\":\"N/A\",\"name\":\"LeadSource\"},{\"name\":\"IsWon\"},{\"name\":\"IsClosed\"},{\"defaultValue\":\"N/A\",\"name\":\"ForecastCategory\"},{\"defaultValue\":\"N/A\",\"name\":\"ForecastCategoryName\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"CreatedDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"CloseDate\"},{\"name\":\"Amount\"},{\"name\":\"CreatedById\"},{\"name\":\"RecordTypeId\"}],\"object\":\"Opportunity\",\"runtime\":{\"SFDCtoken\":\"SFDCtoken\"}}},\"Join_CaseAccountContact\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ContactId\"],\"relationship\":\"Contact\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Id\"]},\"sources\":[\"computeJoin_ServiceCaseTaskEvent\",\"Extract_Contact\"]},\"compute_CaseHistory_PreviousChanges\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"OwnerPreviousChangeDate\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" or 'Field' == \\\"created\\\" then toDate(current('CreatedDate_sec_epoch')) else coalesce(previous('OwnerPreviousChangeDate'), toDate(current('CreatedDate_sec_epoch'))) end\",\"type\":\"Date\"},\"label\":\"OwnerPreviousChangeDate\",\"name\":\"OwnerPreviousChangeDate\"},{\"description\":\"StatusPreviousChangeDate\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Status\\\" or 'Field' == \\\"created\\\" then toDate(current('CreatedDate_sec_epoch')) else coalesce(previous('StatusPreviousChangeDate'), toDate(current('CreatedDate_sec_epoch'))) end\",\"type\":\"Date\"},\"label\":\"StatusPreviousChangeDate\",\"name\":\"StatusPreviousChangeDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"CreatedDate\"}],\"partitionBy\":[\"CaseId\"]},\"sources\":[\"Join_CaseHistory_Case\"]},\"ComputeFilterCaseHistory\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"CaseHistoryFilter\",\"name\":\"CaseHistoryFilter\",\"saqlExpression\":\"case when ( date_diff(\\\"month\\\",toDate(CreatedDate_sec_epoch),now())<=18 and ('Field' == \\\"Status\\\" or 'Field' == \\\"Owner\\\" or 'Field' == \\\"created\\\"))  then \\\"true\\\" else \\\"false\\\" end \",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_CaseHistory\"]},\"Compute_Extract_Task\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"ActivityLastModifiedDate\",\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LastModifiedDate\",\"default\":\"current()\"},\"label\":\"ActivityLastModifiedDate\",\"name\":\"ActivityLastModifiedDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"LastModifiedDate\"}],\"partitionBy\":[\"WhatId\"]},\"sources\":[\"Extract_Task\"]},\"Handle_Only_Activities\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Is Activity\",\"name\":\"IsActivity\",\"saqlExpression\":\"case when 'Case.Id' is null then \\\"No\\\" else \\\"Yes\\\" end\",\"type\":\"Text\"},{\"label\":\"Is Call\",\"name\":\"IsCall\",\"saqlExpression\":\"case when CallDurationInSeconds > 0 then \\\"Yes\\\" else \\\"No\\\" end\",\"type\":\"Text\"},{\"label\":\"Activity Is Closed\",\"name\":\"ActivityIsClosed\",\"saqlExpression\":\"case when ('Type' == \\\"Task\\\" && 'IsClosed' == \\\"true\\\") ||  ('Case.CurrentDate_sec_epoch' > 'EndDateTime_sec_epoch') then \\\"Completed\\\" when ('Type' == \\\"Task\\\" && 'IsClosed' == \\\"false\\\") then \\\"Open\\\" else \\\"Open\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Join_ActivityOwner_Case\"]},\"Extract_User\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CallCenterId\"},{\"name\":\"Name\"},{\"name\":\"UserRoleId\"},{\"name\":\"Id\"}],\"object\":\"User\"}},\"Join_CaseAccountContactUserUserRoleRecordType\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RecordTypeId\"],\"relationship\":\"RecordType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Join_CaseAccountContactUserUserRole\",\"Extract_RecordTypes\"]},\"Filter_CaseHistory_OwnerNameChanges\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"DuplicateOwnerRecords:EQ:true\"},\"sources\":[\"compute_CaseHistory_NullFields\"]},\"compute_CaseHistory_RelativeChanges\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"OwnerPreviousDate\",\"expression\":{\"saqlExpression\":\"coalesce(toDate(previous('OwnerPreviousChangeDate_sec_epoch')), toDate(current('Case.CreatedDate_sec_epoch')))\",\"type\":\"Date\"},\"label\":\"OwnerPreviousDate\",\"name\":\"OwnerPreviousDate\"},{\"description\":\"StatusPreviousDate\",\"expression\":{\"saqlExpression\":\"coalesce(toDate(previous('StatusPreviousChangeDate_sec_epoch')), toDate(current('Case.CreatedDate_sec_epoch')))\",\"type\":\"Date\"},\"label\":\"StatusPreviousDate\",\"name\":\"StatusPreviousDate\"},{\"description\":\"OwnerNextDate\",\"expression\":{\"saqlExpression\":\"coalesce(toDate(next('OwnerNextChangeDate_sec_epoch')), now())\",\"type\":\"Date\"},\"label\":\"OwnerNextDate\",\"name\":\"OwnerNextDate\"},{\"description\":\"StatusNextDate\",\"expression\":{\"saqlExpression\":\"coalesce(toDate(next('StatusNextChangeDate_sec_epoch')), now())\",\"type\":\"Date\"},\"label\":\"StatusNextDate\",\"name\":\"StatusNextDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"CreatedDate\"}],\"partitionBy\":[\"CaseId\"]},\"sources\":[\"Join_CaseHistory_OwnerValue\"]},\"Extract_Case\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"ContactId\"},{\"name\":\"OwnerId\"},{\"name\":\"Id\"},{\"name\":\"BusinessHoursId\"},{\"defaultValue\":\"N/A\",\"name\":\"Origin\"},{\"defaultValue\":\"N/A\",\"name\":\"Complaint_Reason2__c\"},{\"defaultValue\":\"N/A\",\"name\":\"CaseType__c\"},{\"name\":\"IsClosed\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"ClosedDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"CreatedDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"LastModifiedDate\"},{\"name\":\"IsEscalated\"},{\"name\":\"FirstCallResolution__c\"},{\"defaultValue\":\"N/A\",\"name\":\"Status\"},{\"name\":\"SLAStatus__c\"},{\"defaultValue\":\"N/A\",\"name\":\"Complaint_Category__c\"},{\"defaultValue\":\"N/A\",\"name\":\"Priority\"},{\"name\":\"CaseNumber\"},{\"defaultValue\":\"N/A\",\"name\":\"RecordTypeId\"}],\"object\":\"Case\"}},\"Join_CaseAccountContactUser\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OwnerId\"],\"relationship\":\"Owner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CallCenterId\",\"Name\",\"Id\",\"UserRoleId\",\"Type\"]},\"sources\":[\"Join_CaseAccountContact\",\"Append_Queue_User\"]},\"Join_OpportunityRecordTypeAccount\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"relationship\":\"Account\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"Name\",\"Industry\"]},\"sources\":[\"Handle_Null_Opportunity_RecordType\",\"Extract_Account\"]},\"Extract_BusinessHours\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"FridayEndTime\"},{\"name\":\"FridayStartTime\"},{\"name\":\"Name\"},{\"name\":\"MondayEndTime\"},{\"name\":\"MondayStartTime\"},{\"name\":\"SaturdayEndTime\"},{\"name\":\"SaturdayStartTime\"},{\"name\":\"SundayEndTime\"},{\"name\":\"SundayStartTime\"},{\"name\":\"ThursdayEndTime\"},{\"name\":\"ThursdayStartTime\"},{\"name\":\"TimeZoneSidKey\"},{\"name\":\"TuesdayEndTime\"},{\"name\":\"TuesdayStartTime\"},{\"name\":\"WednesdayEndTime\"},{\"name\":\"WednesdayStartTime\"}],\"object\":\"BusinessHours\"}},\"Extract_Queue\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"Group\",\"passthroughFilter\":\"Type = 'Queue'\"}},\"Join_CaseHistory_NewOwner\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"NewOwner\"],\"relationship\":\"NewOwner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CallCenterId\",\"Name\",\"Id\",\"Role.Name\",\"Type\"]},\"sources\":[\"Join_CaseHistory_OldOwner\",\"Join_CaseHistory_Queue_User_UserRole\"]},\"compute_CaseHistory_DateFields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"label\":\"ValidToDate\",\"name\":\"ValidToDate\",\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then toDate('OwnerNextDate_sec_epoch') when 'Field' == \\\"Status\\\" then toDate('StatusNextDate_sec_epoch') else toDate('StatusNextDate_sec_epoch') end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"label\":\"CreatedDatePrev\",\"name\":\"CreatedDatePrev\",\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then toDate('OwnerPreviousDate_sec_epoch') when 'Field' == \\\"Status\\\" then toDate('StatusPreviousDate_sec_epoch') else toDate('StatusPreviousDate_sec_epoch') end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"compute_CaseHistory_OwnerStatusWithCreated\"]},\"compute_CaseHistory_NextChanges\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"OwnerNextChangeDate\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" or 'Field' == \\\"created\\\" then toDate(current('CreatedDate_sec_epoch')) else coalesce(previous('OwnerNextChangeDate'), now()) end\",\"type\":\"Date\"},\"label\":\"OwnerNextChangeDate\",\"name\":\"OwnerNextChangeDate\"},{\"description\":\"StatusNextChangeDate\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Status\\\" or 'Field' == \\\"created\\\" then toDate(current('CreatedDate_sec_epoch')) else coalesce(previous('StatusNextChangeDate'), now()) end\",\"type\":\"Date\"},\"label\":\"StatusNextChangeDate\",\"name\":\"StatusNextChangeDate\"},{\"description\":\"StatusPreviousValue\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Status\\\" then current('OldValue') when 'Field' == \\\"created\\\" then coalesce(previous('StatusPreviousValue'), \\\"created\\\") else coalesce(previous('StatusPreviousValue'), null) end\",\"type\":\"Text\"},\"label\":\"StatusPreviousValue\",\"name\":\"StatusPreviousValue\"},{\"description\":\"OwnerPreviousValue\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then current('OldValue') when 'Field' == \\\"created\\\" then previous('OwnerPreviousValue') else coalesce(previous('OwnerPreviousValue'), null) end\",\"type\":\"Text\"},\"label\":\"OwnerPreviousValue\",\"name\":\"OwnerPreviousValue\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"CreatedDate\"}],\"partitionBy\":[\"CaseId\"]},\"sources\":[\"compute_CaseHistory_PreviousChanges\"]},\"Handle_Null_RecordType\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Case Record Type\",\"name\":\"RecordTypeName\",\"saqlExpression\":\"case when RecordTypeId is null then \\\"N/A\\\" else 'RecordType.Name' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Join_CaseAccountContactUserUserRoleRecordType\"]},\"Join_ActivityOwner_Case\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"WhatId\"],\"relationship\":\"Case\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"Origin\",\"Complaint_Reason2__c\",\"CaseType__c\",\"IsClosed\",\"ClosedDate\",\"CreatedDate\",\"Status\",\"Complaint_Category__c\",\"Priority\",\"CaseNumber\",\"RecordType.Name\",\"Account.Name\",\"Account.Id\",\"DurationCalculatedField\",\"Role.Name\",\"CurrentDate\"]},\"sources\":[\"Join_ActivityOwner\",\"Handle_Null_RecordType\"]},\"computeJoin_ServiceCaseTaskEvent\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"Last LastModifiedDate\",\"name\":\"sum_last_activity\",\"precision\":18,\"saqlExpression\":\"case when ('Task.ActivityLastModifiedDate_sec_epoch' > 'Event.ActivityLastModifiedDate_sec_epoch' && 'Task.ActivityLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then  ('CurrentDate_sec_epoch' - 'Task.ActivityLastModifiedDate_sec_epoch')/86400 when ('Event.ActivityLastModifiedDate_sec_epoch' > 'Task.ActivityLastModifiedDate_sec_epoch' && 'Event.ActivityLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'Event.ActivityLastModifiedDate_sec_epoch')/86400  when ('LastModifiedDate_sec_epoch' >= 'Task.ActivityLastModifiedDate_sec_epoch' && 'LastModifiedDate_sec_epoch' >= 'Event.ActivityLastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400  else ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400 end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Join_ServiceCaseTaskEvent\"]},\"compute_CurrentDateForCase\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"label\":\"CurrentDate\",\"name\":\"CurrentDate\",\"saqlExpression\":\"now()\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"label\":\"ValidToWithNow\",\"name\":\"ValidToWithNow\",\"saqlExpression\":\"case  when ('IsClosed' == \\\"true\\\") then toDate('ClosedDate', \\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else now()  end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_Case\"]},\"Compute_CaseBusinessHours\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"BusinessHours\",\"saqlExpression\":\"('PartialDaysDurationStart'+ 'PartialDaysDurationEnd'+ 'TotalThursdayDuration' + 'TotalFridayDuration' + 'TotalSaturdayDuration'+'TotalSundayDuration'+'TotalMondayDuration'+'TotalTuesdayDuration'+'TotalWednesdayDuration') / 3600\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_CaseBusinessHours_4\"]},\"Join_CaseHistory_NewOwnerID\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"NewValue\"],\"relationship\":\"NewOwnerID\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Filter_CaseHistoryRecords\",\"Join_CaseHistory_Queue_User_UserRole\"]},\"Handle_Null_Opportunity_RecordType\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Opportunity Record Type\",\"name\":\"RecordTypeName\",\"saqlExpression\":\"case when RecordTypeId is null then \\\"N/A\\\" else 'RecordType.Name' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Join_OpportunityRecordType\"]},\"Add_Fields_To_User\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Type\",\"name\":\"Type\",\"saqlExpression\":\"\\\"User\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_User\"]},\"Join_OpportunityRecordTypeAccountCase\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountId\"],\"relationship\":\"Case\",\"rightKey\":[\"AccountId\"],\"rightSelect\":[\"Id\",\"CaseNumber\",\"IsEscalated\",\"Priority\"]},\"sources\":[\"Join_OpportunityRecordTypeAccount\",\"Compute_CaseBusinessHours\"]},\"Filter_CaseHistoryRecords\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"CaseHistoryFilter:EQ:true\"},\"sources\":[\"ComputeFilterCaseHistory\"]},\"Join_ActivityOwner\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OwnerId\"],\"relationship\":\"Owner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Id\",\"UserRoleId\"]},\"sources\":[\"Append_TaskEvent\",\"Extract_User\"]},\"Compute_CaseBusinessHours_1\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"NumWeeks\",\"saqlExpression\":\"case when ('ValidToWithNow_day_epoch' - 'CreatedDate_day_epoch')< 2 then 0 else ('ValidToWithNow_day_epoch' - 'CreatedDate_day_epoch')/7 end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"StartWeekDay\",\"saqlExpression\":\"'CreatedDate_day_epoch'%7\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"EndWeekDay\",\"saqlExpression\":\"'ValidToWithNow_day_epoch'%7\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Join_CaseBusinessHours\"]},\"Add_Fields_To_Queue\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"CallCenterId\",\"name\":\"CallCenterId\",\"saqlExpression\":\"\\\"000000000000000\\\"\",\"type\":\"Text\"},{\"label\":\"Type\",\"name\":\"Type\",\"saqlExpression\":\"\\\"Queue\\\"\",\"type\":\"Text\"},{\"label\":\"UserRoleId\",\"name\":\"UserRoleId\",\"saqlExpression\":\"\\\"000000000000000\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_Queue\"]},\"Compute_CaseBusinessHours_3\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"StartTimeAdjusted\",\"saqlExpression\":\"case when (('CreatedDate_sec_epoch'-('CreatedDate_day_epoch'*86400)) > 'BusinessCreateDateEndTimeInSeconds') then 'BusinessCreateDateEndTimeInSeconds' when (('CreatedDate_sec_epoch'-('CreatedDate_day_epoch'*86400)) < 'BusinessCreateDateStartTimeInSeconds') then 'BusinessCreateDateStartTimeInSeconds' else ('CreatedDate_sec_epoch'-('CreatedDate_day_epoch'*86400)) end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"EndTimeAdjusted\",\"saqlExpression\":\"case when (('ValidToWithNow_sec_epoch'-('ValidToWithNow_day_epoch'*86400)) > 'BusinessValidToEndTimeInSeconds') then 'BusinessValidToEndTimeInSeconds' when (('ValidToWithNow_sec_epoch'-('ValidToWithNow_day_epoch'*86400)) < 'BusinessValidToStartTimeInSeconds') then 'BusinessValidToStartTimeInSeconds' else ('ValidToWithNow_sec_epoch'-('ValidToWithNow_day_epoch'*86400)) end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_CaseBusinessHours_2\"]},\"Compute_CaseBusinessHours_2\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"TotalThursdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((0 < 'EndWeekDay') or (('StartWeekDay' < 0) and (0 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 0 && 0< 'EndWeekDay')) then  'BH.ThursdayDuration'*('NumWeeks' + 1) else 'BH.ThursdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalFridayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((1 < 'EndWeekDay') or (('StartWeekDay' < 1) and (1 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 1 && 1< 'EndWeekDay')) then 'BH.FridayDuration'*('NumWeeks' + 1) else 'BH.FridayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalSaturdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((2 < 'EndWeekDay') or (('StartWeekDay' < 2) and (2 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 2 && 2< 'EndWeekDay')) then 'BH.SaturdayDuration'*('NumWeeks' + 1) else 'BH.SaturdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalSundayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((3 < 'EndWeekDay') or (('StartWeekDay' < 3) and (3 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 3 && 3< 'EndWeekDay')) then 'BH.SundayDuration'*('NumWeeks' + 1) else 'BH.SundayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalMondayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((4 < 'EndWeekDay') or (('StartWeekDay' < 4) and (4 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 4 && 4< 'EndWeekDay')) then 'BH.MondayDuration'*('NumWeeks' + 1) else 'BH.MondayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalTuesdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((5 < 'EndWeekDay') or (('StartWeekDay' < 5) and (5 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 5 && 5< 'EndWeekDay')) then 'BH.TuesdayDuration'*('NumWeeks' + 1) else 'BH.TuesdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalWednesdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((6 < 'EndWeekDay') or (('StartWeekDay' < 6) and (6 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 6 && 6< 'EndWeekDay')) then 'BH.WednesdayDuration'*('NumWeeks' + 1) else 'BH.WednesdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessCreateDateStartTimeInSeconds\",\"saqlExpression\":\"case when 'StartWeekDay' == 0 then 'BH.ThursdayStartTime_sec' when 'StartWeekDay' == 1 then 'BH.FridayStartTime_sec' when 'StartWeekDay' == 2 then 'BH.SaturdayStartTime_sec' when 'StartWeekDay' == 3 then 'BH.SundayStartTime_sec' when 'StartWeekDay' == 4 then 'BH.MondayStartTime_sec' when 'StartWeekDay' == 5 then 'BH.TuesdayStartTime_sec' when 'StartWeekDay' == 6 then 'BH.WednesdayStartTime_sec' else 'BH.WednesdayStartTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessCreateDateEndTimeInSeconds\",\"saqlExpression\":\"case when 'StartWeekDay' == 0 then 'BH.ThursdayEndTime_sec' when 'StartWeekDay' == 1 then 'BH.FridayEndTime_sec' when 'StartWeekDay' == 2 then 'BH.SaturdayEndTime_sec' when 'StartWeekDay' == 3 then 'BH.SundayEndTime_sec' when 'StartWeekDay' == 4 then 'BH.MondayEndTime_sec' when 'StartWeekDay' == 5 then 'BH.TuesdayEndTime_sec' when 'StartWeekDay' == 6 then 'BH.WednesdayEndTime_sec' else 'BH.WednesdayEndTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessValidToStartTimeInSeconds\",\"saqlExpression\":\"case when 'EndWeekDay' == 0 then 'BH.ThursdayStartTime_sec' when 'EndWeekDay' == 1 then 'BH.FridayStartTime_sec' when 'EndWeekDay' == 2 then 'BH.SaturdayStartTime_sec' when 'EndWeekDay' == 3 then 'BH.SundayStartTime_sec' when 'EndWeekDay' == 4 then 'BH.MondayStartTime_sec' when 'EndWeekDay' == 5 then 'BH.TuesdayStartTime_sec' when 'EndWeekDay' == 6 then 'BH.WednesdayStartTime_sec' else 'BH.WednesdayStartTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessValidToEndTimeInSeconds\",\"saqlExpression\":\"case when 'EndWeekDay' == 0 then 'BH.ThursdayEndTime_sec' when 'EndWeekDay' == 1 then 'BH.FridayEndTime_sec' when 'EndWeekDay' == 2 then 'BH.SaturdayEndTime_sec' when 'EndWeekDay' == 3 then 'BH.SundayEndTime_sec' when 'EndWeekDay' == 4 then 'BH.MondayEndTime_sec' when 'EndWeekDay' == 5 then 'BH.TuesdayEndTime_sec' when 'EndWeekDay' == 6 then 'BH.WednesdayEndTime_sec' else 'BH.WednesdayEndTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_CaseBusinessHours_1\"]},\"Compute_CaseBusinessHours_4\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"PartialDaysDurationStart\",\"saqlExpression\":\"case when ('ValidToWithNow_day_epoch' == 'CreatedDate_day_epoch') then 0 else 'BusinessCreateDateEndTimeInSeconds' - 'StartTimeAdjusted' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"PartialDaysDurationEnd\",\"saqlExpression\":\"case when ('ValidToWithNow_day_epoch' == 'CreatedDate_day_epoch') then 'EndTimeAdjusted' - 'StartTimeAdjusted' else 'EndTimeAdjusted' - 'BusinessValidToStartTimeInSeconds' end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_CaseBusinessHours_3\"]},\"Register_Opportunity\":{\"action\":\"register\",\"parameters\":{\"label\":\"ServiceOpportunities\",\"name\":\"ServiceOpportunity\",\"runtime\":{\"SFDCtoken\":\"SFDCtoken\"}},\"sources\":[\"Join_OpportunityRecordTypeAccountCase\"]},\"Register_ServiceCaseHistory\":{\"action\":\"register\",\"parameters\":{\"label\":\"ServiceCaseHistory\",\"name\":\"ServiceCaseHistory\"},\"sources\":[\"Join_CaseHistory_NewOwner\"]},\"Join_CaseHistory_OwnerValue\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OwnerValue\"],\"relationship\":\"OwnerValue\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"CallCenterId\",\"Name\",\"Id\",\"Role.Name\",\"Type\"]},\"sources\":[\"compute_CaseHistory_NextChanges\",\"Join_CaseHistory_Queue_User_UserRole\"]},\"Register_ActivityOwner_Case\":{\"action\":\"register\",\"parameters\":{\"label\":\"ServiceActivity\",\"name\":\"ServiceActivity\",\"runtime\":{\"SFDCtoken\":\"SFDCtoken\"}},\"sources\":[\"Filter_Activities\"]},\"Extract_Task\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"CallObject\"},{\"name\":\"CallDurationInSeconds\"},{\"defaultValue\":\"N/A\",\"name\":\"CallDisposition\"},{\"defaultValue\":\"N/A\",\"name\":\"CallType\"},{\"name\":\"OwnerId\"},{\"defaultValue\":\"N/A\",\"name\":\"Status\"},{\"defaultValue\":\"N/A\",\"name\":\"Priority\"},{\"name\":\"IsClosed\"},{\"defaultValue\":\"N/A\",\"name\":\"TaskSubtype\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"CreatedDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"ActivityDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"LastModifiedDate\"},{\"defaultValue\":\"N/A\",\"name\":\"Subject\"},{\"defaultValue\":\"N/A\",\"name\":\"WhatId\"}],\"object\":\"Task\"}},\"Append_TaskEvent\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Add_Fields_To_Task\",\"Add_Fields_To_Event\"]},\"Append_Queue_User\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Add_Fields_To_Queue\",\"Add_Fields_To_User\"]},\"Compute_WeekDay_Duration\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Sunday Duration\",\"name\":\"SundayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('SundayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'SundayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('SundayEndTimeDate_sec_epoch' == 'SundayStartTimeDate_sec_epoch') then 86400 else 'SundayEndTimeDate_sec_epoch' - 'SundayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Monday Duration\",\"name\":\"MondayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('MondayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'MondayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('MondayEndTimeDate_sec_epoch' == 'MondayStartTimeDate_sec_epoch') then 86400 else 'MondayEndTimeDate_sec_epoch' - 'MondayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Tuesday Duration\",\"name\":\"TuesdayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('TuesdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'TuesdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('TuesdayEndTimeDate_sec_epoch' == 'TuesdayStartTimeDate_sec_epoch') then 86400 else 'TuesdayEndTimeDate_sec_epoch' - 'TuesdayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Wednesday Duration\",\"name\":\"WednesdayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('WednesdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'WednesdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('WednesdayEndTimeDate_sec_epoch' == 'WednesdayStartTimeDate_sec_epoch') then 86400 else 'WednesdayEndTimeDate_sec_epoch' - 'WednesdayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Thursday Duration\",\"name\":\"ThursdayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('ThursdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'ThursdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('ThursdayEndTimeDate_sec_epoch' == 'ThursdayStartTimeDate_sec_epoch') then 86400 else 'ThursdayEndTimeDate_sec_epoch' - 'ThursdayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Friday Duration\",\"name\":\"FridayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('FridayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'FridayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('FridayEndTimeDate_sec_epoch' == 'FridayStartTimeDate_sec_epoch') then 86400 else 'FridayEndTimeDate_sec_epoch' - 'FridayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Saturday Duration\",\"name\":\"SaturdayDuration\",\"precision\":18,\"saqlExpression\":\"case when ('SaturdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'SaturdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('SaturdayEndTimeDate_sec_epoch' == 'SaturdayStartTimeDate_sec_epoch') then 86400 else 'SaturdayEndTimeDate_sec_epoch' - 'SaturdayStartTimeDate_sec_epoch' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Sunday Start Time\",\"name\":\"SundayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('SundayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'SundayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('SundayEndTimeDate_sec_epoch' == 'SundayStartTimeDate_sec_epoch') then 0 else 'SundayStartTimeDate_sec_epoch' - 'SundayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Monday Start Time\",\"name\":\"MondayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('MondayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'MondayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('MondayEndTimeDate_sec_epoch' == 'MondayStartTimeDate_sec_epoch') then 0 else 'MondayStartTimeDate_sec_epoch' - 'MondayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Tuesday Start Time\",\"name\":\"TuesdayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('TuesdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'TuesdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('TuesdayEndTimeDate_sec_epoch' == 'TuesdayStartTimeDate_sec_epoch') then 0 else 'TuesdayStartTimeDate_sec_epoch' - 'TuesdayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Wednesday Start Time\",\"name\":\"WednesdayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('WednesdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'WednesdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('WednesdayEndTimeDate_sec_epoch' == 'WednesdayStartTimeDate_sec_epoch') then 0 else 'WednesdayStartTimeDate_sec_epoch' - 'WednesdayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Thursday Start Time\",\"name\":\"ThursdayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('ThursdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'ThursdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('ThursdayEndTimeDate_sec_epoch' == 'ThursdayStartTimeDate_sec_epoch') then 0 else 'ThursdayStartTimeDate_sec_epoch' - 'ThursdayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Friday Start Time\",\"name\":\"FridayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('FridayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'FridayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('FridayEndTimeDate_sec_epoch' == 'FridayStartTimeDate_sec_epoch') then 0 else 'FridayStartTimeDate_sec_epoch' - 'FridayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Saturday Start Time\",\"name\":\"SaturdayStartTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('SaturdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'SaturdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('SaturdayEndTimeDate_sec_epoch' == 'SaturdayStartTimeDate_sec_epoch') then 0 else 'SaturdayStartTimeDate_sec_epoch' - 'SaturdayStartTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Sunday End Time\",\"name\":\"SundayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('SundayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'SundayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('SundayEndTimeDate_sec_epoch' == 'SundayStartTimeDate_sec_epoch') then 86400 else 'SundayEndTimeDate_sec_epoch' - 'SundayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Monday End Time\",\"name\":\"MondayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('MondayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'MondayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('MondayEndTimeDate_sec_epoch' == 'MondayStartTimeDate_sec_epoch') then 86400 else 'MondayEndTimeDate_sec_epoch' - 'MondayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Tuesday End Time\",\"name\":\"TuesdayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('TuesdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'TuesdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('TuesdayEndTimeDate_sec_epoch' == 'TuesdayStartTimeDate_sec_epoch') then 86400 else 'TuesdayEndTimeDate_sec_epoch' - 'TuesdayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Wednesday End Time\",\"name\":\"WednesdayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('WednesdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'WednesdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('WednesdayEndTimeDate_sec_epoch' == 'WednesdayStartTimeDate_sec_epoch') then 86400 else 'WednesdayEndTimeDate_sec_epoch' - 'WednesdayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Thursday End Time\",\"name\":\"ThursdayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('ThursdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'ThursdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('ThursdayEndTimeDate_sec_epoch' == 'ThursdayStartTimeDate_sec_epoch') then 86400 else 'ThursdayEndTimeDate_sec_epoch' - 'ThursdayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Friday End Time\",\"name\":\"FridayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('FridayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'FridayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('FridayEndTimeDate_sec_epoch' == 'FridayStartTimeDate_sec_epoch') then 86400 else 'FridayEndTimeDate_sec_epoch' - 'FridayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Saturday End Time\",\"name\":\"SaturdayEndTime_sec\",\"precision\":18,\"saqlExpression\":\"case when ('SaturdayEndTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\" or 'SaturdayStartTimeDate' == \\\"3000-10-10T10:10:10.100Z\\\") then 0 when ('SaturdayEndTimeDate_sec_epoch' == 'SaturdayStartTimeDate_sec_epoch') then 86400 else 'SaturdayEndTimeDate_sec_epoch' - 'SaturdayEndTimeDate_day_epoch'*86400 end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_StartEndTimes\"]},\"compute_CaseHistory_CurrentDate\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"label\":\"CurrentDate\",\"name\":\"CurrentDate\",\"saqlExpression\":\"now()\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"ValidToWithNow\",\"saqlExpression\":\"case when 'ValidToDate' == \\\"3000-10-10T10:10:10.100Z\\\" then now() else toDate('ValidToDate', \\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"OwnerDurationInDays\",\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\"  or 'Field' == \\\"created\\\" then date_diff(\\\"day\\\",toDate(CreatedDate_sec_epoch),toDate(OwnerNextDate_sec_epoch)) else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"StatusDurationInDays\",\"saqlExpression\":\"case when 'Field' == \\\"Status\\\" or 'Field' == \\\"created\\\" then date_diff(\\\"day\\\",toDate(CreatedDate_sec_epoch),toDate(StatusNextDate_sec_epoch)) else 0 end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Join_CaseHistoryCaseBusinessHours\"]},\"Add_Fields_To_Event\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"CallObject\",\"name\":\"CallObject\",\"saqlExpression\":\"\\\"000000000000000\\\"\",\"type\":\"Text\"},{\"label\":\"Type\",\"name\":\"Type\",\"saqlExpression\":\"\\\"Event\\\"\",\"type\":\"Text\"},{\"label\":\"CallDisposition\",\"name\":\"CallDisposition\",\"saqlExpression\":\"\\\"Event\\\"\",\"type\":\"Text\"},{\"label\":\"CallType\",\"name\":\"CallType\",\"saqlExpression\":\"\\\"Event\\\"\",\"type\":\"Text\"},{\"label\":\"Status\",\"name\":\"Status\",\"saqlExpression\":\"\\\"Event\\\"\",\"type\":\"Text\"},{\"label\":\"Priority\",\"name\":\"Priority\",\"saqlExpression\":\"\\\"Event\\\"\",\"type\":\"Text\"},{\"label\":\"TaskSubtype\",\"name\":\"TaskSubtype\",\"saqlExpression\":\"EventSubtype\",\"type\":\"Text\"},{\"label\":\"ActivityType\",\"name\":\"ActivityType\",\"saqlExpression\":\"EventSubtype\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"CallDurationInSeconds\",\"name\":\"CallDurationInSeconds\",\"precision\":8,\"saqlExpression\":\"0\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"IsClosed\",\"name\":\"IsClosed\",\"saqlExpression\":\"case when date(ActivityDate_Year,ActivityDate_Month,ActivityDate_Day) in [\\\"1 year ago\\\"..\\\"current day\\\"] then \\\"false\\\" else \\\"true\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_Event\"]},\"compute_CaseHistory_OwnerStatusValues\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"StatusValue\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Status\\\" then current('NewValue') when 'Field' == \\\"created\\\" then coalesce(previous('StatusPreviousValue'), \\\"created\\\") else coalesce(previous('StatusValue'), null) end\",\"type\":\"Text\"},\"label\":\"StatusValue\",\"name\":\"StatusValue\"},{\"description\":\"OwnerValue\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then current('NewValue') when 'Field' == \\\"created\\\" then previous('OwnerPreviousValue') else coalesce(previous('OwnerValue'), null) end\",\"type\":\"Text\"},\"label\":\"OwnerValue\",\"name\":\"OwnerValue\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"CreatedDate\"}],\"partitionBy\":[\"CaseId\"]},\"sources\":[\"compute_CaseHistory_NextChanges\"]},\"compute_CalculatedCaseDuration\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"Case Duration\",\"name\":\"DurationCalculatedField\",\"precision\":18,\"saqlExpression\":\"case  when ('IsClosed' == \\\"true\\\") then ('ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   else ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"compute_CurrentDateForCase\"]},\"Join_CaseHistoryCaseBusinessHours\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Case.BusinessHoursId\"],\"relationship\":\"BH\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"FridayDuration\",\"MondayDuration\",\"SaturdayDuration\",\"SundayDuration\",\"ThursdayDuration\",\"TuesdayDuration\",\"WednesdayDuration\",\"SundayStartTime_sec\",\"MondayStartTime_sec\",\"TuesdayStartTime_sec\",\"WednesdayStartTime_sec\",\"ThursdayStartTime_sec\",\"FridayStartTime_sec\",\"SaturdayStartTime_sec\",\"SundayEndTime_sec\",\"MondayEndTime_sec\",\"TuesdayEndTime_sec\",\"WednesdayEndTime_sec\",\"ThursdayEndTime_sec\",\"FridayEndTime_sec\",\"SaturdayEndTime_sec\"]},\"sources\":[\"compute_CaseHistory_DateFields\",\"Compute_WeekDay_Duration\"]},\"Join_CaseHistory_Queue_User_UserRole\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"UserRoleId\"],\"relationship\":\"Role\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Append_Queue_User\",\"Extract_UserRole\"]},\"Join_OpportunityRecordType\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RecordTypeId\"],\"relationship\":\"RecordType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Extract_Opportunity\",\"Extract_RecordTypes\"]},\"compute_CaseHistory_OwnerStatusWithCreated\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"NewOwnerWithCreated\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then 'NewOwnerID.Name' else coalesce(previous('NewOwnerWithCreated'),'NewValue') end\",\"type\":\"Text\"},\"label\":\"NewOwnerWithCreated\",\"name\":\"NewOwnerWithCreated\"},{\"description\":\"NewStatusWithCreated\",\"expression\":{\"saqlExpression\":\"case when 'Field' == \\\"Status\\\" then 'NewValue' when 'Field' == \\\"created\\\" then 'Field' else coalesce(previous('NewStatusWithCreated'),'NewValue') end\",\"type\":\"Text\"},\"label\":\"NewStatusWithCreated\",\"name\":\"NewStatusWithCreated\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"CreatedDate\"}],\"partitionBy\":[\"CaseId\"]},\"sources\":[\"compute_CaseHistory_RelativeChanges\"]},\"Extract_CaseHistory\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"CaseId\"},{\"name\":\"CreatedById\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"CreatedDate\"},{\"name\":\"Field\"},{\"name\":\"Id\"},{\"name\":\"NewValue\"},{\"name\":\"OldValue\"}],\"object\":\"CaseHistory\"}},\"Extract_RecordTypes\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"}],\"object\":\"RecordType\"}},\"Join_CaseBusinessHours\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"BusinessHoursId\"],\"relationship\":\"BH\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"FridayDuration\",\"MondayDuration\",\"SaturdayDuration\",\"SundayDuration\",\"ThursdayDuration\",\"TuesdayDuration\",\"WednesdayDuration\",\"SundayStartTime_sec\",\"MondayStartTime_sec\",\"TuesdayStartTime_sec\",\"WednesdayStartTime_sec\",\"ThursdayStartTime_sec\",\"FridayStartTime_sec\",\"SaturdayStartTime_sec\",\"SundayEndTime_sec\",\"MondayEndTime_sec\",\"TuesdayEndTime_sec\",\"WednesdayEndTime_sec\",\"ThursdayEndTime_sec\",\"FridayEndTime_sec\",\"SaturdayEndTime_sec\"]},\"sources\":[\"compute_CalculatedCaseDuration\",\"Compute_WeekDay_Duration\"]},\"compute_CaseHistory_NullFields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Non Null fields?\",\"name\":\"DuplicateOwnerRecords\",\"saqlExpression\":\"case when 'NewOwnerID.Name' is not null or  'Field' == \\\"created\\\" or 'Field' == \\\"Status\\\" then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Join_CaseHistory_NewOwnerID\"]},\"Extract_Account\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"defaultValue\":\"N/A\",\"name\":\"BillingState\"},{\"defaultValue\":\"N/A\",\"name\":\"Industry\"}],\"object\":\"Account\"}},\"Join_ServiceCaseTaskEvent\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"relationship\":\"Event\",\"rightKey\":[\"WhatId\"],\"rightSelect\":[\"ActivityLastModifiedDate\"]},\"sources\":[\"Join_ServiceCaseServiceTask\",\"Compute_Extract_Event\"]},\"computeJoin_ServiceCaseTask\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"Last LastModifiedDate\",\"name\":\"sum_last_activity\",\"precision\":18,\"saqlExpression\":\"case when ('Task.ActivityLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'Task.ActivityLastModifiedDate_sec_epoch')/86400 when ('LastModifiedDate_sec_epoch' >= 'Task.ActivityLastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400  else ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400 end\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Join_ServiceCaseServiceTask\"]},\"Compute_BusinessHours\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Business Hours\",\"name\":\"BusinessHours\",\"saqlExpression\":\"('PartialDaysDurationStart'+ 'PartialDaysDurationEnd'+ 'TotalThursdayDuration' + 'TotalFridayDuration' + 'TotalSaturdayDuration'+'TotalSundayDuration'+'TotalMondayDuration'+'TotalTuesdayDuration'+'TotalWednesdayDuration') / 3600\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_BusinessHours_4\"]},\"Add_Fields_To_Task\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"label\":\"EndDateTime\",\"name\":\"EndDateTime\",\"saqlExpression\":\"now()\",\"type\":\"Date\"},{\"label\":\"Type\",\"name\":\"Type\",\"saqlExpression\":\"\\\"Task\\\"\",\"type\":\"Text\"},{\"label\":\"EventSubtype\",\"name\":\"EventSubtype\",\"saqlExpression\":\"TaskSubtype\",\"type\":\"Text\"},{\"label\":\"ActivityType\",\"name\":\"ActivityType\",\"saqlExpression\":\"TaskSubtype\",\"type\":\"Text\"},{\"label\":\"ShowAs\",\"name\":\"ShowAs\",\"saqlExpression\":\"\\\"Task\\\"\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"DurationInMinutes\",\"name\":\"DurationInMinutes\",\"precision\":8,\"saqlExpression\":\"0\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_Task\"]},\"Extract_UserRole\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"ParentRoleId\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"LastModifiedDate\"},{\"name\":\"LastModifiedById\"},{\"name\":\"SystemModstamp\"}],\"object\":\"UserRole\"}},\"Join_CaseAccountContactUserUserRole\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Owner.UserRoleId\"],\"relationship\":\"Role\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"ParentRoleId\"]},\"sources\":[\"Join_CaseAccountContactUser\",\"Extract_UserRole\"]},\"Compute_Extract_Event\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"description\":\"ActivityLastModifiedDate\",\"expression\":{\"offset\":\"first()\",\"sourceField\":\"LastModifiedDate\",\"default\":\"current()\"},\"label\":\"ActivityLastModifiedDate\",\"name\":\"ActivityLastModifiedDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"LastModifiedDate\"}],\"partitionBy\":[\"WhatId\"]},\"sources\":[\"Extract_Event\"]},\"Compute_BusinessHours_1\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"NumWeeks\",\"saqlExpression\":\"case when ('ValidToWithNow_day_epoch' - 'CreatedDate_day_epoch')< 2 then 0 else ('ValidToWithNow_day_epoch' - 'CreatedDate_day_epoch')/7 end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"StartWeekDay\",\"saqlExpression\":\"'CreatedDate_day_epoch'%7\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"EndWeekDay\",\"saqlExpression\":\"'ValidToWithNow_day_epoch'%7\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"compute_CaseHistory_CurrentDate\"]},\"Compute_BusinessHours_2\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"TotalThursdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((0 < 'EndWeekDay') or (('StartWeekDay' < 0) and (0 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 0 && 0< 'EndWeekDay')) then  'BH.ThursdayDuration'*('NumWeeks' + 1) else 'BH.ThursdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalFridayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((1 < 'EndWeekDay') or (('StartWeekDay' < 1) and (1 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 1 && 1< 'EndWeekDay')) then 'BH.FridayDuration'*('NumWeeks' + 1) else 'BH.FridayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalSaturdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((2 < 'EndWeekDay') or (('StartWeekDay' < 2) and (2 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 2 && 2< 'EndWeekDay')) then 'BH.SaturdayDuration'*('NumWeeks' + 1) else 'BH.SaturdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalSundayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((3 < 'EndWeekDay') or (('StartWeekDay' < 3) and (3 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 3 && 3< 'EndWeekDay')) then 'BH.SundayDuration'*('NumWeeks' + 1) else 'BH.SundayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalMondayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((4 < 'EndWeekDay') or (('StartWeekDay' < 4) and (4 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 4 && 4< 'EndWeekDay')) then 'BH.MondayDuration'*('NumWeeks' + 1) else 'BH.MondayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalTuesdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((5 < 'EndWeekDay') or (('StartWeekDay' < 5) and (5 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 5 && 5< 'EndWeekDay')) then 'BH.TuesdayDuration'*('NumWeeks' + 1) else 'BH.TuesdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"TotalWednesdayDuration\",\"saqlExpression\":\"case when ( ('EndWeekDay' < 'StartWeekDay') and ((6 < 'EndWeekDay') or (('StartWeekDay' < 6) and (6 < ('EndWeekDay'+7))))) or ('StartWeekDay' != 'EndWeekDay' && ('StartWeekDay' < 6 && 6< 'EndWeekDay')) then 'BH.WednesdayDuration'*('NumWeeks' + 1) else 'BH.WednesdayDuration'*'NumWeeks' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessCreateDateStartTimeInSeconds\",\"saqlExpression\":\"case when 'StartWeekDay' == 0 then 'BH.ThursdayStartTime_sec' when 'StartWeekDay' == 1 then 'BH.FridayStartTime_sec' when 'StartWeekDay' == 2 then 'BH.SaturdayStartTime_sec' when 'StartWeekDay' == 3 then 'BH.SundayStartTime_sec' when 'StartWeekDay' == 4 then 'BH.MondayStartTime_sec' when 'StartWeekDay' == 5 then 'BH.TuesdayStartTime_sec' when 'StartWeekDay' == 6 then 'BH.WednesdayStartTime_sec' else 'BH.WednesdayStartTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessCreateDateEndTimeInSeconds\",\"saqlExpression\":\"case when 'StartWeekDay' == 0 then 'BH.ThursdayEndTime_sec' when 'StartWeekDay' == 1 then 'BH.FridayEndTime_sec' when 'StartWeekDay' == 2 then 'BH.SaturdayEndTime_sec' when 'StartWeekDay' == 3 then 'BH.SundayEndTime_sec' when 'StartWeekDay' == 4 then 'BH.MondayEndTime_sec' when 'StartWeekDay' == 5 then 'BH.TuesdayEndTime_sec' when 'StartWeekDay' == 6 then 'BH.WednesdayEndTime_sec' else 'BH.WednesdayEndTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessValidToStartTimeInSeconds\",\"saqlExpression\":\"case when 'EndWeekDay' == 0 then 'BH.ThursdayStartTime_sec' when 'EndWeekDay' == 1 then 'BH.FridayStartTime_sec' when 'EndWeekDay' == 2 then 'BH.SaturdayStartTime_sec' when 'EndWeekDay' == 3 then 'BH.SundayStartTime_sec' when 'EndWeekDay' == 4 then 'BH.MondayStartTime_sec' when 'EndWeekDay' == 5 then 'BH.TuesdayStartTime_sec' when 'EndWeekDay' == 6 then 'BH.WednesdayStartTime_sec' else 'BH.WednesdayStartTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"BusinessValidToEndTimeInSeconds\",\"saqlExpression\":\"case when 'EndWeekDay' == 0 then 'BH.ThursdayEndTime_sec' when 'EndWeekDay' == 1 then 'BH.FridayEndTime_sec' when 'EndWeekDay' == 2 then 'BH.SaturdayEndTime_sec' when 'EndWeekDay' == 3 then 'BH.SundayEndTime_sec' when 'EndWeekDay' == 4 then 'BH.MondayEndTime_sec' when 'EndWeekDay' == 5 then 'BH.TuesdayEndTime_sec' when 'EndWeekDay' == 6 then 'BH.WednesdayEndTime_sec' else 'BH.WednesdayEndTime_sec' end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_BusinessHours_1\"]},\"compute_CaseHistory_OldNewStatus\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"New Status\",\"name\":\"NewStatus\",\"saqlExpression\":\"case when 'Field' == \\\"created\\\" then \\\"New\\\" when 'Field' == \\\"Status\\\" then 'NewValue' else\\\"NA\\\" end \",\"type\":\"Text\"},{\"label\":\"Old Status\",\"name\":\"OldStatus\",\"saqlExpression\":\"case when 'Field' == \\\"closed\\\" then \\\"Closed\\\" when 'Field' == \\\"Status\\\" then 'OldValue' else \\\"NA\\\" end \",\"type\":\"Text\"},{\"defaultValue\":\"N/A\",\"label\":\"New Owner\",\"name\":\"NewOwner\",\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then 'NewValue' else\\\"NA\\\" end \",\"type\":\"Text\"},{\"defaultValue\":\"N/A\",\"label\":\"Old Owner\",\"name\":\"OldOwner\",\"saqlExpression\":\"case when 'Field' == \\\"Owner\\\" then 'OldValue' else \\\"NA\\\" end \",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Date Diff Old\",\"name\":\"DateDiffOld\",\"precision\":18,\"saqlExpression\":\"('CreatedDate_sec_epoch' - 'CreatedDatePrev_sec_epoch')/86400\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Date Diff New\",\"name\":\"DateDiffNew\",\"precision\":18,\"saqlExpression\":\"case  when ('Case.IsClosed' == \\\"true\\\"  && CreatedDate <= 'Case.ClosedDate') then ('Case.ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   when ('Case.IsClosed' == \\\"true\\\" &&  CreatedDate > 'Case.ClosedDate') then 0 else ('ValidToWithNow_sec_epoch' - 'CreatedDate_sec_epoch')/86400 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"false\",\"label\":\"Change After CloseDate\",\"name\":\"ChangeAfterCloseDate\",\"saqlExpression\":\"case  when ('Field' == \\\"Owner\\\" && 'CreatedDate' > 'Case.ClosedDate') then \\\"true\\\"  else \\\"false\\\" end \",\"type\":\"Text\"},{\"defaultValue\":\"false\",\"label\":\"Last Change\",\"name\":\"IsLastChange\",\"saqlExpression\":\"case when ('Case.ClosedDate' is null && 'ValidToDate' == \\\"3000-10-10T10:10:10.100Z\\\") then \\\"true\\\" when ('CreatedDate' <= 'Case.ClosedDate' && 'ValidToDate' > 'Case.ClosedDate') then \\\"true\\\" else \\\"false\\\" end \",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_BusinessHours\"]},\"Compute_BusinessHours_3\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"StartTimeAdjusted\",\"saqlExpression\":\"case when (('CreatedDate_sec_epoch'-('CreatedDate_day_epoch'*86400)) > 'BusinessCreateDateEndTimeInSeconds') then 'BusinessCreateDateEndTimeInSeconds' when (('CreatedDate_sec_epoch'-('CreatedDate_day_epoch'*86400)) < 'BusinessCreateDateStartTimeInSeconds') then 'BusinessCreateDateStartTimeInSeconds' else ('CreatedDate_sec_epoch'-('CreatedDate_day_epoch'*86400)) end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"EndTimeAdjusted\",\"saqlExpression\":\"case when (('ValidToWithNow_sec_epoch'-('ValidToWithNow_day_epoch'*86400)) > 'BusinessValidToEndTimeInSeconds') then 'BusinessValidToEndTimeInSeconds' when (('ValidToWithNow_sec_epoch'-('ValidToWithNow_day_epoch'*86400)) < 'BusinessValidToStartTimeInSeconds') then 'BusinessValidToStartTimeInSeconds' else ('ValidToWithNow_sec_epoch'-('ValidToWithNow_day_epoch'*86400)) end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_BusinessHours_2\"]},\"Filter_Activities\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"IsActivity:EQ:Yes\"},\"sources\":[\"Handle_Only_Activities\"]},\"Extract_Event\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"OwnerId\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"CreatedDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"LastModifiedDate\"},{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"isYearEndFiscalYear\":false,\"name\":\"ActivityDate\"},{\"name\":\"EndDateTime\"},{\"defaultValue\":\"N/A\",\"name\":\"Subject\"},{\"name\":\"ShowAs\"},{\"name\":\"DurationInMinutes\"},{\"defaultValue\":\"N/A\",\"name\":\"EventSubtype\"},{\"defaultValue\":\"N/A\",\"name\":\"WhatId\"}],\"object\":\"Event\"}},\"Compute_BusinessHours_4\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"name\":\"PartialDaysDurationStart\",\"saqlExpression\":\"case when ('ValidToWithNow_day_epoch' == 'CreatedDate_day_epoch') then 0 else 'BusinessCreateDateEndTimeInSeconds' - 'StartTimeAdjusted' end\",\"scale\":0,\"type\":\"Numeric\"},{\"name\":\"PartialDaysDurationEnd\",\"saqlExpression\":\"case when ('ValidToWithNow_day_epoch' == 'CreatedDate_day_epoch') then 'EndTimeAdjusted' - 'StartTimeAdjusted' else 'EndTimeAdjusted' - 'BusinessValidToStartTimeInSeconds' end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_BusinessHours_3\"]},\"Compute_StartEndTimes\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"SundayStartTimeDate\",\"saqlExpression\":\"case when 'SundayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'SundayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"SundayEndTimeDate\",\"saqlExpression\":\"case when 'SundayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'SundayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"MondayStartTimeDate\",\"saqlExpression\":\"case when 'MondayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'MondayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"MondayEndTimeDate\",\"saqlExpression\":\"case when 'MondayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'MondayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"TuesdayStartTimeDate\",\"saqlExpression\":\"case when 'TuesdayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'TuesdayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"TuesdayEndTimeDate\",\"saqlExpression\":\"case when 'TuesdayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'TuesdayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"WednesdayStartTimeDate\",\"saqlExpression\":\"case when 'WednesdayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'WednesdayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"WednesdayEndTimeDate\",\"saqlExpression\":\"case when 'WednesdayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'WednesdayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"ThursdayStartTimeDate\",\"saqlExpression\":\"case when 'ThursdayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'ThursdayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"ThursdayEndTimeDate\",\"saqlExpression\":\"case when 'ThursdayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'ThursdayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"FridayStartTimeDate\",\"saqlExpression\":\"case when 'FridayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'FridayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"FridayEndTimeDate\",\"saqlExpression\":\"case when 'FridayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'FridayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"SaturdayStartTimeDate\",\"saqlExpression\":\"case when 'SaturdayStartTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'SaturdayStartTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"},{\"format\":\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\",\"name\":\"SaturdayEndTimeDate\",\"saqlExpression\":\"case when 'SaturdayEndTime' is null then toDate(\\\"3000-10-10T10:10:10.100Z\\\",\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") else toDate(\\\"2000-01-01T\\\"+'SaturdayEndTime',\\\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\\\") end\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_BusinessHours\"]},\"Register_Case\":{\"action\":\"register\",\"parameters\":{\"label\":\"ServiceCase\",\"name\":\"ServiceCase\",\"runtime\":{\"SFDCtoken\":\"SFDCtoken\"}},\"sources\":[\"Handle_Null_RecordType\"]}}}",null]