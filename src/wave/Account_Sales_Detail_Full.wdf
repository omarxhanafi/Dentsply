["{\"nodes\":{\"Extract UserTerritory2Association\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"UserId\"},{\"name\":\"Territory2Id\"}],\"object\":\"UserTerritory2Association\"}},\"JoinCurrencyCodetoCurrencytype\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"USD\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"PriceUSD\",\"rightKey\":[\"IsoCode\"],\"rightSelect\":[\"ConversionRate\"],\"runtime\":{\"name\":\"JoinCurrencyCodetoCurrencytype\"}},\"sources\":[\"CalcCurrencyCodes\",\"Extract_currencytype\"]},\"Only 728\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CompanyCode__c == \\\"728\\\"\"},\"sources\":[\"Create InvoiceNumber Prefix\"]},\"Extract Territory2 - Region\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"},{\"name\":\"ParentTerritory2Id\"}],\"object\":\"Territory2\"}},\"Extract Territory2 - Area\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"}],\"object\":\"Territory2\"}},\"Remove null Order Number for 728\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"!('InvoiceNumberPrefix' in [\\\"000\\\",\\\"002\\\",\\\"003\\\"])\"},\"sources\":[\"Only 728\"]},\"Import QuotaProducts\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"Quota_Products_v2\"}},\"Import CountryMapping\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"CountryMapping\"}},\"Change CompanyCodes\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"New_CompanyCode__c\",\"name\":\"New_CompanyCode__c\",\"saqlExpression\":\"case when 'CompanyCode__c' in [\\\"NO\\\",\\\"FI\\\",\\\"SE\\\",\\\"DK\\\",\\\"DE\\\"] then \\\"EU\\\" else 'CompanyCode__c' end\",\"type\":\"Text\"},{\"label\":\"ERPCustomerNumber\",\"name\":\"ERPCustomerNumber\",\"saqlExpression\":\"case when 'ErpCustomerLocationCode__c' is not null then 'ErpCustomerNumber__c' + \\\"-\\\" + 'ErpCustomerLocationCode__c' else 'ErpCustomerNumber__c' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Extract SalesAnalytics\"]},\"Register AccountSalesDetail\":{\"action\":\"register\",\"parameters\":{\"label\":\"Account Sales Detail\",\"name\":\"AccountSalesDetail\",\"rowLevelSecurityFilter\":\"false\",\"rowLevelSharingSource\":\"Account\"},\"sources\":[\"Join Security\"]},\"Filter Order Country\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'a.Country__c' in [\\\"BE\\\",\\\"NL\\\",\\\"LU\\\",\\\"DE\\\",\\\"AT\\\",\\\"ES\\\",\\\"PT\\\",\\\"AD\\\",\\\"FR\\\",\\\"IN\\\",\\\"CH\\\"]\"},\"sources\":[\"Import SFDC Orders\"]},\"Drop SFDC Order Fields\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"CreatedBy.Name\"},{\"name\":\"o.Order_Type__c\"},{\"name\":\"CurrencyIsoCode\"},{\"name\":\"Pricebook.Pricebook.Name\"},{\"name\":\"Product2Id\"},{\"name\":\"a.OneSF_Id__c\"},{\"name\":\"o.AccountId\"},{\"name\":\"OfferCode.Type__c\"},{\"name\":\"OfferCode.Offer_Code_Type__c\"},{\"name\":\"o.OrderNumber\"},{\"name\":\"OfferCode.Name\"},{\"name\":\"Total_Line_Item_Price__c\"},{\"name\":\"Quantity\"},{\"name\":\"o.EffectiveDate\"},{\"name\":\"o.CreatedDate\"},{\"name\":\"o.submitted_date__c\"},{\"name\":\"OrderDate\"},{\"name\":\"Owner.Name\"},{\"name\":\"Owner.Role.Name\"}],\"mode\":\"select\"},\"sources\":[\"Filter Order Country\"]},\"Import ANZ SalesGroup CommissionGroup\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"ANZ_SalesGroup_CommissionGroup\"}},\"Calculate Relative Fields\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"Invoice_Date__c\"},\"label\":\"FirstInvoiceDate\",\"name\":\"FirstInvoiceDate\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"Invoice_Number__c\"},\"label\":\"FirstInvoiceNumber\",\"name\":\"FirstInvoiceNumber\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"Invoice_Date__c\"}],\"partitionBy\":[\"OneSF_Id__c\"]},\"sources\":[\"Filter Normal Sales\"]},\"Extract_currencytype\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"ConversionRate\"},{\"name\":\"IsoCode\"},{\"name\":\"IsCorporate\"}],\"object\":\"currencytype\",\"runtime\":{\"name\":\"Extract_currencytype\"}}},\"Join Accounts to Sales Data\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OneSF_Id__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ac\",\"rightKey\":[\"OneSF_Id__c\"],\"rightSelect\":[\"Account_Strategy_SBU_PROS__c\",\"gaa.Hierarchy.AreaId\",\"Account_Strategy_ATL_ISUS__c\",\"Customer_Group_Description__c\",\"Leads.Owner.Full_Name__c\",\"Parent_Geographical_Area__c\",\"gaa.Hierarchy.PreferredTerritoryCode\",\"gaa.Hierarchy.Territory.TerritoryManagerId\",\"State__c\",\"ETM2_Zip_Code__c\",\"Custom_ETM2_Owner_Combined__c\",\"gaa.Hierarchy.AreaName\",\"SegmentPreventive__c\",\"DSContact.Full_Name__c\",\"Leads.Category__c\",\"SegmentOrthodontics__c\",\"ParentAccountOneSFId\",\"Leads.Name\",\"ShippingState\",\"gaa.Hierarchy.Territory.TerritoryManager\",\"ParentAccountName\",\"Clinic_Treatment_Focus__c\",\"Account_Strategy_Simplant__c\",\"RecordTypeId\",\"Main_DS_Contact__c\",\"isEcomCustomer\",\"ShippingCity\",\"ParentId\",\"CIM360_Status__c\",\"NameLocal\",\"Continent__c\",\"Campaign.LeadSource\",\"WonLostStatus_Implants_EndField__c\",\"User_Country__c\",\"gaa.Hierarchy.PreferredGeographyTypeName\",\"Specialty_Dental__c\",\"BillingCity\",\"gaa.Hierarchy.Territory.SalesChannel\",\"Segment_Ortho_Clear_Aligners__c\",\"Account_Strategy_ATL_Abut__c\",\"Name\",\"Campaign.c.crt.Name\",\"gaa.Hierarchy.RegionName\",\"Hyperion_Customer_Group__c\",\"p.Name\",\"SegmentCADCAMmanual__c\",\"OneSF_Id__c\",\"CurrencyIsoCode\",\"TerritoryUsers__c\",\"ShippingStreet\",\"SegmentImplantsDigital__c\",\"BillingState\",\"Rating\",\"SegmentImplants__c\",\"Account_Type_Specialty__c\",\"Campaign.c.Name\",\"Leads.Status__c\",\"gaa.Hierarchy.RegionId\",\"ShippingCountry\",\"Account_Strategy_Implants_Basic__c\",\"SegmentLab__c\",\"AccountNumber\",\"SegmentEquipment__c\",\"BillingStreet\",\"gaa.Hierarchy.ETMCountry\",\"Account_Strategy_SBU_REST__c\",\"PostalCodePrefix\",\"Account_Strategy_SBU_ENDO__c\",\"share_of_potential_implants__c\",\"gaa.Hierarchy.Territory.TerritoryCode\",\"AccountSource\",\"Customer_Group__c\",\"Account_Strategy_Implants__c\",\"SegmentEndodontics__c\",\"Invoice_Movex__c\",\"Do_Not_Mail_Account__c\",\"Assigned_User_s__c\",\"Vat_Registration_No__c\",\"gaa.Hierarchy.PreferredAreaCode\",\"ShippingPostalCode\",\"AccountRecordType.Name\",\"Id\",\"Status__c\",\"Customer_Sub_segment__c\",\"OwnerId\",\"SegmentConsumables__c\",\"Leads.LeadList.Name\",\"ParentAccountId\",\"Country__c\",\"Leads.Source__c\",\"gaa.Hierarchy.PreferredRegionName\",\"SegmentTreatmentCenters__c\",\"Market__c\",\"OneAccount_Type__c\",\"CustomTierLightning__c\",\"Type\",\"AccountPlan.AccountProgram.Name\",\"BillingCountry\",\"Consigment_Stock__c\",\"gaa.Hierarchy.TerritoryId\",\"SegmentRestorative__c\",\"Product_Area__c\",\"gaa.Hierarchy.Area.AreaDirector\",\"Campaign.c.Type\",\"MainDSContactTeam__c\",\"gaa.Hierarchy.PreferredAreaName\",\"Do_Not_Call__c\",\"BillingPostalCode\",\"gaa.Hierarchy.Region.RegionManager\",\"Leads.Brand__c\",\"Segment__c\",\"ImplantsSoldBuckets\",\"Volume_Implants__c\",\"Movex_Email__c\",\"CorporationName__c\",\"General_Info_Email__c\",\"gaa.Hierarchy.PreferredTerritoryName\",\"SegmentInstruments__c\",\"gaa.Hierarchy.PreferredRegionCode\",\"Do_Not_Fax__c\",\"gaa.Hierarchy.Area.AreaDirectorId\",\"Leads.CreatedBy.Full_Name__c\",\"ParentAccountInformation__c\",\"OneDSParticipant\",\"Provider_Sector__c\",\"SegmentDigital__c\",\"gaa.Hierarchy.TerritoryName\",\"Movex__c\",\"gaa.AccountTier.TierName\",\"Phone\",\"Account_Strategy_SBU_ORTH__c\",\"Sub_Account_Type__c\",\"Account_Strategy_SBU_PREV__c\",\"SourceRecord.Customer_Id__c\",\"SegmentImaging__c\",\"ImplantsWonLost\",\"gaa.Hierarchy.Region.RegionManagerId\",\"Germany_Implants_Account_Strategy\",\"Account_Strategy_End_LY_Implants__c\",\"of_Prophylaxis_Chairs__c\",\"Implants_Potential_Year__c\",\"of_Dental_Students_Year__c\",\"of_Dental_Hygienists__c\",\"of_treatment_Chairs__c\",\"of_Endo_Cases__c\",\"of_Implant_Procedures__c\",\"CFEs_All_Last_6__c\",\"of_Dentists__c\",\"CFEs_All_CY__c\",\"of_Other__c\",\"of_Dental_Professionals__c\",\"of_BUYDS_Accounts__c\",\"AccAgg.CR12.ImplantUnitsQty\",\"of_Dental_Technicians__c\",\"AccAgg.PR12.ImplantUnitsQty\",\"of_Denturists__c\",\"CreatedDate\"]},\"sources\":[\"Set New Fields and Calculations\",\"Import Accounts\"]},\"Remove Old Sales Type\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"Sales_Type__c\"},{\"name\":\"Customer_Order_Number__c\"},{\"name\":\"Order_Number__c\"},{\"name\":\"FirstInvoiceNumber\"},{\"name\":\"Product2Sales.Business_Area_Description__c\"},{\"name\":\"Product2Sales.Business_Area_Name__c\"},{\"name\":\"Product2Sales.D_Level1__c\"},{\"name\":\"Product2Sales.D_Level2__c\"},{\"name\":\"Product2Sales.D_Level3__c\"},{\"name\":\"Product2Sales.D_Level4__c\"},{\"name\":\"Product2Sales.GPP_Code__c\"},{\"name\":\"Product2Sales.GPP_Desc__c\"},{\"name\":\"Product2Sales.Market__c\"},{\"name\":\"Product2Sales.PG1_Code__c\"},{\"name\":\"Product2Sales.PG1_Desc__c\"},{\"name\":\"Product2Sales.PG2_Code__c\"},{\"name\":\"Product2Sales.PG2_Desc__c\"},{\"name\":\"Product2Sales.PG3_Code__c\"},{\"name\":\"Product2Sales.PG3_Desc__c\"},{\"name\":\"Product2Sales.PG4_Code__c\"},{\"name\":\"Product2Sales.PG4_Desc__c\"},{\"name\":\"Product2Sales.Brand__c\"},{\"name\":\"Product2Sales.BrandDescGDW__c\"},{\"name\":\"Product2Sales.BrandCodeGDW__c\"},{\"name\":\"Product2Sales.Product_Category__c\"},{\"name\":\"Product2Sales.Product_Line__c\"},{\"name\":\"Product2Sales.Business_Area_Code__c\"},{\"name\":\"Product2Sales.Business_Area_Brand__c\"},{\"name\":\"Product2Sales.SBU_Code__c\"},{\"name\":\"Product2Sales.SBU_Name__c\"}],\"mode\":\"drop\"},\"sources\":[\"Join Dates to Sales\"]},\"Join User To Territory\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"UserId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"User\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Full_Name__c\",\"Id\"]},\"sources\":[\"Extract UserTerritory2Association\",\"Extract User\"]},\"CalcCurrencyCodes\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"USD\",\"name\":\"USD\",\"saqlExpression\":\"\\\"USD\\\"\",\"type\":\"Text\"},{\"label\":\"EUR\",\"name\":\"EUR\",\"saqlExpression\":\"\\\"EUR\\\"\",\"type\":\"Text\"},{\"label\":\"DataSource\",\"name\":\"DataSource\",\"saqlExpression\":\"\\\"Global Data Warehouse\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true,\"runtime\":{\"name\":\"CalcCurrencyCodes\"}},\"sources\":[\"Create New_LocalSKUKey__c\"]},\"Join Region Users\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Region\",\"rightKey\":[\"Territory2Id\"],\"rightSelect\":[\"User.Full_Name__c\",\"User.Id\"]},\"sources\":[\"Extract Territory2 - Region\",\"Join User To Territory\"]},\"Join Oracle Product Hierarchy\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Product2Sales.Article__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"oph\",\"rightKey\":[\"SKU\"],\"rightSelect\":[\"VendorName\",\"Category\",\"SubBrand\",\"Segment\",\"Brand\",\"ERPCompanyCode\",\"SubSegment\",\"CatalogName\",\"Division\",\"SKU\",\"Variety\",\"ProductLine\",\"Devices\",\"isDashboardProduct\",\"Mapping.SalesChannel\"]},\"sources\":[\"Append Sales Data\",\"Import OracleProductHiearchy\"]},\"Extract Account for Security\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"OneSF_Id__c\"},{\"name\":\"Id\"}],\"object\":\"Account\"}},\"Filter for ANZ Country Codes\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"Country__c in [\\\"AU\\\",\\\"NZ\\\"]\"},\"sources\":[\"Import Geography Account Alignment\"]},\"Extract SalesAnalytics\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Address_Number__c\"},{\"name\":\"View_Wave_Data__c\"},{\"name\":\"Campaign_Code__c\"},{\"name\":\"Contract_Voucher__c\"},{\"name\":\"CreatedDate\"},{\"name\":\"CurrencyIsoCode\"},{\"name\":\"Customer_Order_Number__c\"},{\"name\":\"Dealer_Branch__c\"},{\"name\":\"IsDeleted\"},{\"name\":\"Discount_Amount__c\"},{\"name\":\"Discount_Model__c\"},{\"name\":\"DistributorId__c\"},{\"name\":\"Invoice_Date__c\"},{\"name\":\"Invoice_Line__c\"},{\"name\":\"Invoice_Number__c\"},{\"name\":\"LastReferencedDate\"},{\"name\":\"LastViewedDate\"},{\"name\":\"LocalSKUKey__c\"},{\"name\":\"OneSF_Id__c\"},{\"name\":\"Order_Number__c\"},{\"name\":\"Order_Type__c\"},{\"name\":\"Our_Reference__c\"},{\"name\":\"Price__c\"},{\"name\":\"Project_Element__c\"},{\"name\":\"Purchasing_Contract_External_ID__c\"},{\"name\":\"Quantity__c\"},{\"name\":\"Sales_Attribute_1__c\"},{\"name\":\"Sales_Attribute_2__c\"},{\"name\":\"Sales_Attribute_3__c\"},{\"name\":\"Sales_Attribute_4__c\"},{\"name\":\"Sales_Attribute_5__c\"},{\"name\":\"Sales_History_External_ID__c\"},{\"name\":\"Sales_Type__c\"},{\"name\":\"SystemModstamp\"},{\"name\":\"Total_Price__c\"},{\"name\":\"Total_Value__c\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"CIM360Id__c\"},{\"name\":\"SourceErpId__c\"},{\"name\":\"OwnerId\"},{\"name\":\"Name\"},{\"name\":\"LocalCurrencyPrice__c\"},{\"name\":\"LocalCurrencyDiscount__c\"},{\"name\":\"LocalCurrencyCode__c\"},{\"name\":\"LastModifiedById\"},{\"name\":\"KitLocalSKU__c\"},{\"name\":\"KitHeaderGDWUniqueKey__c\"},{\"name\":\"KitGlobalSKU__c\"},{\"name\":\"IsKitItem__c\"},{\"name\":\"IsKitHeader__c\"},{\"name\":\"GDWUniqueKey__c\"},{\"name\":\"ERPNumber__c\"},{\"name\":\"CreatedById\"},{\"name\":\"CompanyCode__c\"},{\"name\":\"Account__c\"},{\"name\":\"SBU__c\"},{\"name\":\"Product__c\"},{\"name\":\"LocalCurrencyPreciousMetalsValue__c\"},{\"name\":\"InvoiceCurrencyPreciousMetalsValue__c\"},{\"name\":\"ErpCustomerLocationCode__c\"},{\"name\":\"ErpCustomerNumber__c\"},{\"name\":\"SalesOrigin__c\"},{\"name\":\"PatientCaseId__c\"}],\"object\":\"sales_analytics__c\"}},\"Join Dates to Sales\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Invoice_Date__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"time\",\"rightKey\":[\"Today\"],\"rightSelect\":[\"isPYTD\",\"DayOfWeekNumber\",\"is2019\",\"is2019MTD\",\"isLast6MoPY\",\"Month\",\"isP2YTD\",\"is2019QTD\",\"isCR12\",\"isP2MTD\",\"isLast3MoPY\",\"is2019YTD\",\"isP2QTD\",\"isCMTD\",\"isCQTD\",\"isPR12\",\"isLast9MoPY\",\"isCYTD\",\"isPMTD\",\"isPYFull\",\"Year\",\"YearMonth\",\"isLast3Mo\",\"isLast9Mo\",\"isP2YFull\",\"isLast6Mo\",\"isPQTD\",\"FirstDayOfYearLY\",\"SameDayLY\",\"R366ago\",\"LastDayOfMonthLY\",\"FirstDayOfQuarterLY\",\"LastDayOfQuarterLY\",\"FirstDayOfMonthLY\",\"FirstDayOfQuarter\",\"FirstDayOfYear\",\"LastDayOfYearLY\",\"R365ago\",\"Today\",\"FirstDayOfMonth\",\"R730ago\",\"isPYMFull\",\"isPYQFull\"]},\"sources\":[\"Fix Sales Type\",\"Calendar\"]},\"Join Territories to Accounts\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ac.Id\"],\"operation\":\"LookupMultiValue\",\"relationship\":\"t\",\"rightKey\":[\"ObjectId\"],\"rightSelect\":[\"Territory.Area.Area.User.Full_Name__c\",\"Territory.Area.Name\",\"Territory.Id\",\"Territory.Name\",\"Territory.Region.Name\",\"Territory.Region.Region.User.Full_Name__c\",\"Territory.Territory.User.Full_Name__c\",\"Territory.Territory.User.Id\",\"Territory.Region.Region.User.Id\",\"Territory.Area.Area.User.Id\"]},\"sources\":[\"Join Accounts to Sales Data\",\"Join Territories to Account Assocaition\"]},\"New_LocalSKUKey_c\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"LocalSKU_Key_up\",\"name\":\"LocalSKU_Key_up\",\"saqlExpression\":\"upper('New_LocalSKUKey__c')\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"CalcEUR\"]},\"Filter Private Label Only\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"('oph.Brand' matches \\\"private label\\\")\"},\"sources\":[\"Join Oracle Product Hierarchy\"]},\"Join Products to SFDC Orders\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LocalSKUKey__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Product2Sales\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Global.SBU_Code__c\",\"Business_Area_Name__c\",\"Global.PG2_Desc__c\",\"PG3_Desc__c\",\"Global.Brand__c\",\"Global.BrandDescGDW__c\",\"Global.D_Level4__c\",\"Global.QuotaProducts.CountryQuotaProduct\",\"Global.Business_Area_Description__c\",\"Global.Dashboard_Product__c\",\"Business_Area_Code__c\",\"Global.SBU_Name__c\",\"GPP_Desc__c\",\"PG2_Code__c\",\"GPP_Code__c\",\"D_Level3__c\",\"Id\",\"Global.GPP_Desc__c\",\"Global.PG2_Code__c\",\"PG4_Desc__c\",\"Description\",\"SBU_Code__c\",\"Article__c\",\"Business_Area_Description__c\",\"PG3_Code__c\",\"D_Level4__c\",\"Global.Product_Category__c\",\"RecordTypeId\",\"OBIProducts.ProductId\",\"Market__c\",\"D_Level1__c\",\"Global.D_Level1__c\",\"Product_Category__c\",\"Global.PG3_Code__c\",\"ERP_Source_Description__c\",\"BrandCodeGDW__c\",\"Global.BrandCodeGDW__c\",\"SKUKey__c\",\"Global.PG1_Desc__c\",\"Global.PG4_Desc__c\",\"PG1_Desc__c\",\"Global.Business_Area_Code__c\",\"Name\",\"D_Level2__c\",\"PG4_Code__c\",\"Global.Product_Line__c\",\"SBU_Name__c\",\"BrandDescGDW__c\",\"Global.D_Level3__c\",\"Global.Business_Area_Name__c\",\"Global.Business_Area_Brand__c\",\"Product_Line__c\",\"Global.GPP_Code__c\",\"Global.PG3_Desc__c\",\"IsActive\",\"Global.PG4_Code__c\",\"PG2_Desc__c\",\"Global.D_Level2__c\",\"RecordType.Name\",\"GlobalSKUMapping__c\",\"Business_Area_Brand__c\",\"Iberia_SBU_Groups\",\"Company_Code__c\",\"PG1_Code__c\",\"Brand__c\",\"Global.PG1_Code__c\",\"Unit_of_Measurement__c\",\"Dashboard_Product__c\",\"ERP_Source__c\",\"ClinicalSolutionProduct_SUC\",\"ClinicalSolutionProduct_Implants\",\"ClinicalSolutionProduct_EndoResto\",\"ClinicalSolutionProduct_Class2\"]},\"sources\":[\"Drop Original Order Fields\",\"Import Products\"]},\"Import Propel Historical\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"Propel_Historical\"}},\"Extract Territory2 - Territory\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"ParentTerritory2Id\"},{\"name\":\"Name\"}],\"object\":\"Territory2\"}},\"Join Area Users\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Area\",\"rightKey\":[\"Territory2Id\"],\"rightSelect\":[\"User.Full_Name__c\",\"User.Id\"]},\"sources\":[\"Extract Territory2 - Area\",\"Join User To Territory\"]},\"Extract DNA Sales 2\":{\"action\":\"digest\",\"parameters\":{\"connectionName\":\"DSAzure\",\"fields\":[{\"name\":\"ACCNT_ID\"},{\"name\":\"ACTION\"},{\"name\":\"CURRENCY\"},{\"name\":\"DATE_CREATED\"},{\"name\":\"INVOICE_DATE\"},{\"name\":\"PROD_ID\"},{\"name\":\"QTY\"},{\"name\":\"SALES_TYPE\"},{\"name\":\"S_AMT\"},{\"name\":\"INVOICE_NUM\"},{\"name\":\"DISTRIBUTOR_NUM\"},{\"name\":\"DISTRIBUTOR_NAME\"},{\"name\":\"COUNTRY\"},{\"name\":\"BRANCH_NUM\"},{\"name\":\"BRANCH_NAME\"}],\"object\":\"USC_Sales_History_Split_2\"}},\"Extract DNA Sales 3\":{\"action\":\"digest\",\"parameters\":{\"connectionName\":\"DSAzure\",\"fields\":[{\"name\":\"ACCNT_ID\"},{\"name\":\"PROD_ID\"},{\"name\":\"INVOICE_DATE\"},{\"name\":\"S_AMT\"},{\"name\":\"QTY\"},{\"name\":\"CURRENCY\"},{\"name\":\"SALES_TYPE\"},{\"name\":\"ACTION\"},{\"name\":\"DATE_CREATED\"},{\"name\":\"INVOICE_NUM\"},{\"name\":\"BRANCH_NAME\"},{\"name\":\"BRANCH_NUM\"},{\"name\":\"COUNTRY\"},{\"name\":\"DISTRIBUTOR_NUM\"},{\"name\":\"DISTRIBUTOR_NAME\"}],\"object\":\"USC_Sales_History_Split_3\"}},\"Extract DNA Sales 1\":{\"action\":\"digest\",\"parameters\":{\"connectionName\":\"DSAzure\",\"fields\":[{\"name\":\"ACCNT_ID\"},{\"name\":\"ACTION\"},{\"name\":\"CURRENCY\"},{\"name\":\"DATE_CREATED\"},{\"name\":\"INVOICE_DATE\"},{\"name\":\"PROD_ID\"},{\"name\":\"QTY\"},{\"name\":\"SALES_TYPE\"},{\"name\":\"S_AMT\"},{\"name\":\"INVOICE_NUM\"},{\"name\":\"BRANCH_NAME\"},{\"name\":\"BRANCH_NUM\"},{\"name\":\"DISTRIBUTOR_NAME\"},{\"name\":\"DISTRIBUTOR_NUM\"},{\"name\":\"COUNTRY\"}],\"object\":\"USC_Sales_History_Split_1\"}},\"Import Geography Account Alignment\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"GeographyAccountAlignment\"}},\"Rename SFDC Order Fields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"\\\"true\\\"\",\"label\":\"View_Wave_Data__c\",\"name\":\"View_Wave_Data__c\",\"saqlExpression\":\"\\\"true\\\"\",\"type\":\"Text\"},{\"defaultValue\":\"\\\"Salesforce Orders\\\"\",\"label\":\"DataSource\",\"name\":\"DataSource\",\"saqlExpression\":\"\\\"Salesforce Orders\\\"\",\"type\":\"Text\"},{\"label\":\"Invoice_Number__c\",\"name\":\"Invoice_Number__c\",\"saqlExpression\":\"\\\"-\\\"\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"Invoice_Date__c\",\"name\":\"Invoice_Date__c\",\"saqlExpression\":\"toDate(substr('o.EffectiveDate',1,10),\\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"},{\"label\":\"LocalSKUKey__c\",\"name\":\"LocalSKUKey__c\",\"saqlExpression\":\"'Product2Id'\",\"type\":\"Text\"},{\"label\":\"OneSF_Id__c\",\"name\":\"OneSF_Id__c\",\"saqlExpression\":\"'a.OneSF_Id__c'\",\"type\":\"Text\"},{\"label\":\"Sales_Type__c\",\"name\":\"Sales_Type__c\",\"saqlExpression\":\"'o.Order_Type__c'\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Quantity__c\",\"name\":\"Quantity__c\",\"precision\":18,\"saqlExpression\":\"'Quantity'\",\"scale\":5,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Total_Value__c\",\"name\":\"Total_Value__c\",\"precision\":18,\"saqlExpression\":\"'Total_Line_Item_Price__c'\",\"scale\":5,\"type\":\"Numeric\"},{\"label\":\"Customer_Order_Number__c\",\"name\":\"Customer_Order_Number__c\",\"saqlExpression\":\"'o.OrderNumber'\",\"type\":\"Text\"},{\"label\":\"OrderCreatedByName\",\"name\":\"OrderCreatedByName\",\"saqlExpression\":\"'CreatedBy.Name'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Drop SFDC Order Fields\"]},\"Append SalesAnalytics\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":false},\"sources\":[\"Remove null Order Number for 728\",\"Filter Not 728\"]},\"Filter InHouse Only\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'Sales_Type__c' == \\\"Internal\\\"\"},\"sources\":[\"Join Oracle Product Hierarchy\"]},\"Extract User\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Full_Name__c\"},{\"name\":\"Id\"}],\"object\":\"User\"}},\"Join Region to Territory\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"ParentTerritory2Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Region\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"ParentTerritory2Id\",\"Region.User.Full_Name__c\",\"Region.User.Id\"]},\"sources\":[\"Join Territory Users\",\"Join Region Users\"]},\"Filter DNA Dates\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"INVOICE_DATE >=  date_to_string(toDate(date_to_epoch(now())-94608000),\\\"yyyy-MM-dd\\\")\"},\"sources\":[\"Combine DNA Extracts\"]},\"Join ANZ SalesGroups to Sales\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OneSF_Id__c\",\"ANZCommissionGroup.CommissionGroup\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"CommissionGroup\",\"rightKey\":[\"OneSF_Id__c\",\"ANZSalesGroup.CommissionGroup\"],\"rightSelect\":[\"ANZSalesGroup.TerritoryCode\",\"ANZSalesGroup.SalesBranch\",\"ANZSalesGroup.SpecialistType\",\"Hierarchy.RegionName\",\"Hierarchy.TerritoryName\",\"Hierarchy.AreaName\",\"Hierarchy.Area.AreaDirector\",\"Hierarchy.Region.RegionManager\",\"Hierarchy.Territory.TerritoryManager\"]},\"sources\":[\"Join ANZ CommissionGroup to Sales\",\"Join ANZ Sales Group to GAA\"]},\"Import OracleProductHiearchy\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"OracleProductHierarchy1\"}},\"Filter Normal Sales\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"!('oph.Brand' matches \\\"private label\\\") && 'Sales_Type__c' != \\\"Internal\\\" && !(('DataSource' == \\\"US Indirect Sales (Siebel)\\\" and 'oph.Division' in [\\\"Maillefer\\\", \\\"Roydent\\\"]))\"},\"sources\":[\"Join Oracle Product Hierarchy\"]},\"Create ANZ Extra Fields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Territory Code - Commission Group (ANZ)\",\"name\":\"ANZ_TerritoryCode_CommissionGroup\",\"saqlExpression\":\"case when coalesce('CommissionGroup.ANZSalesGroup.TerritoryCode',\\\"\\\") != \\\"\\\" then  + 'CommissionGroup.ANZSalesGroup.TerritoryCode' + \\\" - \\\" + 'ANZCommissionGroup.CommissionGroup' end\",\"type\":\"Text\"},{\"label\":\"Territory Code - Specialist Type (ANZ)\",\"name\":\"ANZ_TerritoryCode_SpecialistType\",\"saqlExpression\":\"case when coalesce('CommissionGroup.ANZSalesGroup.TerritoryCode',\\\"\\\") != \\\"\\\" then 'CommissionGroup.ANZSalesGroup.TerritoryCode' + \\\" - \\\" + 'CommissionGroup.ANZSalesGroup.SpecialistType' end\",\"type\":\"Text\"},{\"label\":\"ANZ_Mo_TerritoryCode_CommissionGroup\",\"name\":\"ANZ_Mo_TerritoryCode_CommissionGroup\",\"saqlExpression\":\"case when coalesce('MonthlyCommissionGroup.ANZSalesGroup.TerritoryCode',\\\"\\\") != \\\"\\\" then  + 'MonthlyCommissionGroup.ANZSalesGroup.TerritoryCode' + \\\" - \\\" + 'ANZCommissionGroup.CommissionGroup' end\",\"type\":\"Text\"},{\"label\":\"ANZ_Mo_TerritoryCode_SpecialistType\",\"name\":\"ANZ_Mo_TerritoryCode_SpecialistType\",\"saqlExpression\":\"case when coalesce('MonthlyCommissionGroup.ANZSalesGroup.TerritoryCode',\\\"\\\") != \\\"\\\" then 'MonthlyCommissionGroup.ANZSalesGroup.TerritoryCode' + \\\" - \\\" + 'MonthlyCommissionGroup.ANZSalesGroup.SpecialistType' end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Join Monthly ANZ SalesGroups to Sales\"]},\"Register In House Sales\":{\"action\":\"register\",\"parameters\":{\"label\":\"InHouseSales\",\"name\":\"InHouseSales\"},\"sources\":[\"Filter InHouse Only\"]},\"Join Area to Region\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Region.ParentTerritory2Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Area\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\",\"Area.User.Full_Name__c\",\"Area.User.Id\"]},\"sources\":[\"Join Region to Territory\",\"Join Area Users\"]},\"Join Security\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OneSF_Id__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ac2\",\"rightKey\":[\"OneSF_Id__c\"],\"rightSelect\":[\"Id\"]},\"sources\":[\"Create ANZ Extra Fields\",\"Extract Account for Security\"]},\"Create New_LocalSKUKey__c\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"New_LocalSKUKey__c\",\"name\":\"New_LocalSKUKey__c\",\"saqlExpression\":\"'LocalSKUKey__c'\",\"type\":\"Text\"},{\"label\":\"SourceERPId\",\"name\":\"SourceERPId\",\"saqlExpression\":\"number_to_string('SourceErpId__c',\\\"#########\\\")\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Append SalesAnalytics\"]},\"Append Sales Data\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Join Products to DNA Sales\",\"Join Products to Sales History\",\"Join Products to SFDC Orders\",\"Join Products to IndonesiaSales\"]},\"Remove New CompanyCode\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"New_CompanyCode__c\"}],\"mode\":\"drop\"},\"sources\":[\"Rename CompanyCode\"]},\"Set New Fields and Calculations\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Sales_Type__c\",\"name\":\"Sales_Type__c\",\"saqlExpression\":\"'New_Sales_Type__c'\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"CMTD\",\"name\":\"CMTD\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.Today' && 'Invoice_Date__c' >= 'time.FirstDayOfMonth' then 'Total_Value__c' else null end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"CYTD\",\"name\":\"CYTD\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.Today' && 'Invoice_Date__c' >= 'time.FirstDayOfYear' then 'Total_Value__c' else null end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Rolling_12\",\"name\":\"Rolling_12\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.Today' && 'Invoice_Date__c' >= 'time.R365ago' then 'Total_Value__c' else null end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Rolling_13_24\",\"name\":\"Rolling_13_24\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.R366ago' && 'Invoice_Date__c' >= 'time.R730ago' then 'Total_Value__c' else null end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"PYTD\",\"name\":\"PYTD\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.SameDayLY' && 'Invoice_Date__c' >= 'time.FirstDayOfYearLY' then 'Total_Value__c' else null end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"PYMTD\",\"name\":\"PYMTD\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.SameDayLY' && 'Invoice_Date__c' >= 'time.FirstDayOfMonthLY' then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"CMTD_Qty\",\"name\":\"CMTD_Qty\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.Today' && 'Invoice_Date__c' >= 'time.FirstDayOfMonth' then 'Quantity__c' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"CYTD_Qty\",\"name\":\"CYTD_Qty\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.Today' && 'Invoice_Date__c' >= 'time.FirstDayOfYear' then 'Quantity__c' else null end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Rolling_12_Qty\",\"name\":\"Rolling_12_Qty\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.Today' && 'Invoice_Date__c' >= 'time.R365ago' then 'Quantity__c' else null end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Rolling_13_24_Qty\",\"name\":\"Rolling_13_24_Qty\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.R366ago' && 'Invoice_Date__c' >= 'time.R730ago' then 'Quantity__c' else null end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"PYTD_Qty\",\"name\":\"PYTD_Qty\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.SameDayLY' && 'Invoice_Date__c' >= 'time.FirstDayOfYearLY' then 'Quantity__c' else null end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"PYMTD_Qty\",\"name\":\"PYMTD_Qty\",\"precision\":15,\"saqlExpression\":\"case when 'Invoice_Date__c' <= 'time.SameDayLY' && 'Invoice_Date__c' >= 'time.FirstDayOfMonthLY' then 'Quantity__c' else null end\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"ProductSBUParent\",\"name\":\"ProductSBUParent\",\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Name__c' == \\\"Implants\\\" then \\\"Implants\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"Endodontics\\\" then \\\"PRE\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"Preventive\\\" then \\\"PRE\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"Restorative\\\" then \\\"PRE\\\" else \\\"Other\\\" end\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"isInHouseSale\",\"name\":\"isInHouseSale\",\"precision\":6,\"saqlExpression\":\"0\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"isPrivateLabelSale\",\"name\":\"isPrivateLabelSale\",\"precision\":6,\"saqlExpression\":\"0\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"ProductSBUParent_Italy\",\"name\":\"ProductSBUParent_Italy\",\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Name__c' == \\\"Implants\\\" then \\\"Implants\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"CAD/CAM\\\" then \\\"Implants\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"Endodontics\\\" then \\\"PRE\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"Preventive\\\" then \\\"PRE\\\" when 'Product2Sales.Global.SBU_Name__c' == \\\"Restorative\\\" then \\\"PRE\\\"  when 'Product2Sales.Global.SBU_Name__c' == \\\"Instruments\\\" then \\\"PRE\\\" else \\\"Other\\\" end\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"ISUSConnectorQty\",\"name\":\"ISUSConnectorQty\",\"precision\":12,\"saqlExpression\":\"case when ('Product2Sales.Global.PG2_Code__c' in [\\\"ID41\\\",\\\"ID42\\\",\\\"ID43\\\",\\\"ID44\\\"]) && (index_of('Product2Sales.Article__c',\\\"-\\\") > 0) then string_to_number(substr('Product2Sales.Article__c',index_of('Product2Sales.Article__c',\\\"-\\\") + 1,len('Product2Sales.Article__c'))) * 'Quantity__c' else 0 end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"ISUSConnectorSales\",\"name\":\"ISUSConnectorSales\",\"precision\":15,\"saqlExpression\":\"case when ('Product2Sales.Global.PG2_Code__c' in [\\\"ID41\\\",\\\"ID42\\\",\\\"ID43\\\",\\\"ID44\\\"]) && (index_of('Product2Sales.Article__c',\\\"-\\\") > 0) then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Order_Number__c\",\"name\":\"Order_Number__c\",\"saqlExpression\":\"'New_Order_Number__c'\",\"type\":\"Text\"},{\"defaultValue\":\"1\",\"label\":\"ViewAllEinsteinData\",\"name\":\"ViewAllEinsteinData\",\"precision\":5,\"saqlExpression\":\"1\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Customer_Order_Number__c\",\"name\":\"Customer_Order_Number__c\",\"saqlExpression\":\"'New_Customer_Order_Number__c'\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"TotalValueWithPreciousMetals\",\"name\":\"TotalValueWithPreciousMetals\",\"precision\":18,\"saqlExpression\":\"Total_Value__c + LocalCurrencyPreciousMetalsValue__c\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"ImplantUnitsQty\",\"name\":\"ImplantUnitsQty\",\"precision\":15,\"saqlExpression\":\"case when ('Product2Sales.Global.Product_Line__c' == \\\"Implants\\\" && 'Product2Sales.Global.Product_Category__c' == \\\"Implants\\\")  || ('ProductGroup4' in [\\\"MIS Implants C1\\\", \\\"MIS Implants MF4\\\", \\\"MIS Implants MF5\\\", \\\"MIS Implants MF7\\\", \\\"MIS Implants V3\\\"]) then 'Quantity__c' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"ImplantUnitsSales\",\"name\":\"ImplantUnitsSales\",\"precision\":15,\"saqlExpression\":\"case when ('Product2Sales.Global.Product_Line__c' == \\\"Implants\\\" && 'Product2Sales.Global.Product_Category__c' == \\\"Implants\\\")  || ( 'ProductGroup4' in [\\\"MIS Implants C1\\\", \\\"MIS Implants MF4\\\", \\\"MIS Implants MF5\\\", \\\"MIS Implants MF7\\\", \\\"MIS Implants V3\\\"]) then 'Total_Value__c' end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"ImplantManufacturer\",\"name\":\"ImplantManufacturer\",\"saqlExpression\":\"case \\nwhen 'Sales_Attribute_4__c' == \\\"AN\\\" then \\\"Ankylos\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"AT\\\" then \\\"Astra Tech TX\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"B3\\\" then \\\"Biomet 3i\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"BH\\\" then \\\"BioHorizons\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"CM\\\" then \\\"Camlog\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"DF\\\" then \\\"XiVE/Firalit\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"EV\\\" then \\\"Astra Tech EV\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"KD\\\" then \\\"Keystone Dental\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"MS\\\" then \\\"MIS\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"NB\\\" then \\\"Nobel Biocare\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"OS\\\" then \\\"Osteem\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"ST\\\" then \\\"Straumann\\\"\\nwhen 'Sales_Attribute_4__c' == \\\"ZD\\\" then \\\"Zimmer Dental\\\"\\nelse 'Sales_Attribute_4__c'\\nend\",\"type\":\"Text\"},{\"label\":\"Class2 Clinical Solution Product\",\"name\":\"Class2ClinicalSolutionProduct\",\"saqlExpression\":\"case \\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD222A\\\",\\\"RD224C\\\",\\\"RD224F\\\"] then \\\"CERAM.X SPECTRA\\\"\\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD1174\\\"] then \\\"P&B active\\\"\\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD2224\\\"] then \\\"SDR FLOW+\\\"\\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD2237\\\"] then \\\"Surefil ONE\\\"\\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD3822\\\",\\\"RD3813\\\"] then \\\"PALODENT\\\"\\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD3335\\\"] then \\\"SmartLite\\\"\\nwhen 'Product2Sales.Global.PG4_Code__c' in [\\\"RD3410\\\",\\\"RD3440\\\",\\\"RD3411\\\",\\\"RD3430\\\"] then \\\"ENHANCE\\\"\\nelse \\\"N/A\\\"\\nend\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Remove Old Sales Type\"]},\"Rename CompanyCode\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"CompanyCode__c\",\"name\":\"CompanyCode__c\",\"saqlExpression\":\"'New_CompanyCode__c'\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Remove Old CompanyCode\"]},\"Rename DNA Fields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"CurrencyIsoCode\",\"name\":\"CurrencyIsoCode\",\"saqlExpression\":\"'CURRENCY'\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd\",\"label\":\"Invoice_Date__c\",\"name\":\"Invoice_Date__c\",\"saqlExpression\":\"toDate(substr('INVOICE_DATE',1,10),\\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"},{\"label\":\"LocalSKUKey__c\",\"name\":\"LocalSKUKey__c\",\"saqlExpression\":\"'PROD_ID'\",\"type\":\"Text\"},{\"label\":\"OneSF_Id__c\",\"name\":\"OneSF_Id__c\",\"saqlExpression\":\"'ACCNT_ID'\",\"type\":\"Text\"},{\"label\":\"Quantity__c\",\"name\":\"Quantity__c\",\"precision\":18,\"saqlExpression\":\"'QTY'\",\"scale\":6,\"type\":\"Numeric\"},{\"label\":\"Total_Value__c\",\"name\":\"Total_Value__c\",\"precision\":18,\"saqlExpression\":\"'S_AMT'\",\"scale\":6,\"type\":\"Numeric\"},{\"label\":\"View_Wave_Data__c\",\"name\":\"View_Wave_Data__c\",\"precision\":18,\"saqlExpression\":\"\\\"true\\\"\",\"type\":\"Text\"},{\"label\":\"Sales_Type__c\",\"name\":\"Sales_Type__c\",\"saqlExpression\":\"\\\"Indirect\\\"\",\"type\":\"Text\"},{\"label\":\"Invoice_Number__c\",\"name\":\"Invoice_Number__c\",\"saqlExpression\":\"\\\"-\\\"\",\"type\":\"Text\"},{\"label\":\"DataSource\",\"name\":\"DataSource\",\"saqlExpression\":\"\\\"US Indirect Sales (Siebel)\\\"\",\"type\":\"Text\"},{\"label\":\"DistributorNumber\",\"name\":\"DistributorNumber\",\"saqlExpression\":\"DISTRIBUTOR_NUM\",\"type\":\"Text\"},{\"label\":\"DistributorName\",\"name\":\"DistributorName\",\"saqlExpression\":\"DISTRIBUTOR_NAME\",\"type\":\"Text\"},{\"label\":\"DealerBranchName\",\"name\":\"DealerBranchName\",\"saqlExpression\":\"BRANCH_NAME\",\"type\":\"Text\"},{\"label\":\"DealerBranchNum\",\"name\":\"DealerBranchNum\",\"saqlExpression\":\"BRANCH_NUM\",\"type\":\"Text\"},{\"label\":\"DealerBranchCountry\",\"name\":\"DealerBranchCountry\",\"saqlExpression\":\"COUNTRY\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Filter DNA Dates\"]},\"Filter Not 728\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"CompanyCode__c != \\\"728\\\"\"},\"sources\":[\"Create InvoiceNumber Prefix\"]},\"Register Private Label Sales\":{\"action\":\"register\",\"parameters\":{\"label\":\"PrivateLabelSales\",\"name\":\"PrivateLabelSales\"},\"sources\":[\"Filter Private Label Only\"]},\"Append ANZ Item CommissionGroup\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":false},\"sources\":[\"613 Company Code\",\"614 Company Code\"]},\"Fix Sales Type\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"New_Sales_Type__c\",\"name\":\"New_Sales_Type__c\",\"saqlExpression\":\"case when 'Sales_Type__c' == \\\"Indirect\\\" then \\\"Indirect\\\"\\nwhen 'Sales_Type__c' == \\\"Internal\\\" then \\\"Internal\\\"\\nwhen 'Sales_Type__c' == \\\"External\\\" then \\\"Direct\\\"\\nwhen 'Sales_Type__c' == \\\"E\\\" then \\\"External\\\"\\nwhen 'Sales_Type__c' == \\\"S\\\" then \\\"Samples\\\"\\nwhen 'Sales_Type__c' == \\\"Not Defined\\\" then \\\"Direct\\\"\\nwhen 'Sales_Type__c' == \\\"D\\\" then \\\"Dealer Discount\\\" \\nwhen 'Sales_Type__c' == \\\"I\\\" then \\\"Internal\\\"\\nwhen 'Sales_Type__c' == \\\"\\\" then \\\"Unknown\\\"\\nelse 'Sales_Type__c' end\",\"type\":\"Text\"},{\"label\":\"ProductGroup1\",\"name\":\"ProductGroup1\",\"saqlExpression\":\"case when DataSource == \\\"US Indirect Sales (Siebel)\\\" then 'Product2Sales.D_Level1__c' else 'Product2Sales.Global.PG1_Desc__c' end\",\"type\":\"Text\"},{\"label\":\"ProductGroup2\",\"name\":\"ProductGroup2\",\"saqlExpression\":\"case when DataSource == \\\"US Indirect Sales (Siebel)\\\" then 'Product2Sales.D_Level2__c' else 'Product2Sales.Global.PG2_Desc__c' end\",\"type\":\"Text\"},{\"label\":\"ProductGroup3\",\"name\":\"ProductGroup3\",\"saqlExpression\":\"case when DataSource == \\\"US Indirect Sales (Siebel)\\\" then 'Product2Sales.D_Level3__c' else 'Product2Sales.Global.PG3_Desc__c' end\",\"type\":\"Text\"},{\"label\":\"ProductGroup4\",\"name\":\"ProductGroup4\",\"saqlExpression\":\"case when DataSource == \\\"US Indirect Sales (Siebel)\\\" then 'Product2Sales.D_Level4__c' else 'Product2Sales.Global.PG4_Desc__c' end\",\"type\":\"Text\"},{\"label\":\"ProductSBU\",\"name\":\"ProductSBU\",\"saqlExpression\":\"'oph.Division'\",\"type\":\"Text\"},{\"format\":\"yyyy-MM-dd\",\"label\":\"Today\",\"name\":\"Today\",\"saqlExpression\":\"toDate(date_to_epoch(now()))\",\"type\":\"Date\"},{\"defaultValue\":\"0\",\"label\":\"UnitPrice\",\"name\":\"UnitPrice\",\"precision\":15,\"saqlExpression\":\"'Total_Value__c'/'Quantity__c'\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"New_Order_Number__c\",\"name\":\"New_Order_Number__c\",\"saqlExpression\":\"coalesce('Order_Number__c',\\\"-\\\")\",\"type\":\"Text\"},{\"label\":\"New_Customer_Order_Number__c\",\"name\":\"New_Customer_Order_Number__c\",\"saqlExpression\":\"coalesce('Customer_Order_Number__c',\\\"-\\\")\",\"type\":\"Text\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Atl Abut - Comp System\",\"name\":\"Quantity_AtlAbut_CompSystem\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\" && 'Product2Sales.Global.Product_Category__c' == \\\"Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"IBP51\\\" && 'Sales_Attribute_4__c' == \\\"Comp System\\\" then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Atlantis - Comp System\",\"name\":\"Sales_Atl_CompSystem\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"IBP51\\\" && 'Sales_Attribute_4__c' == \\\"Comp System\\\" then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Atl Abut - DI System\",\"name\":\"Quantity_AtlAbut_DISystem\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\" && 'Product2Sales.Global.Product_Category__c' == \\\"Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"IBP51\\\" && 'Sales_Attribute_4__c' == \\\"DI System\\\" then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Atlantis - DI System\",\"name\":\"Sales_Atl_DISystem\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"IBP51\\\" && 'Sales_Attribute_4__c' == \\\"DI System\\\" then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - All Implant\",\"name\":\"Sales_AllImplant\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Digital Dentistry\",\"name\":\"Sales_DigitalDentistry\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"   then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Implants\",\"name\":\"Sales_Implants\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\" then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Regenerative\",\"name\":\"Sales_Regenerative\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"IR\\\" then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Stock Abut\",\"name\":\"Quantity_StockAbut\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Stock Abut\",\"name\":\"Sales_StockAbut\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Ankylos\",\"name\":\"Quantity_Ankylos\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I003\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Ankylos\",\"name\":\"Sales_Ankylos\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I003\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Stock Abut - Ankylos\",\"name\":\"Quantity_StockAbut_Ankylos\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I003\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Stock Abut - Ankylos\",\"name\":\"Sales_StockAbut_Ankylos\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I003\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Stock Abut - ATIS\",\"name\":\"Quantity_StockAbut_ATIS\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\" && ('Product2Sales.Global.BrandCodeGDW__c' == \\\"I002\\\" || 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I007\\\")  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Stock Abut - ATIS\",\"name\":\"Sales_StockAbut_ATIS\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\" && ('Product2Sales.Global.BrandCodeGDW__c' == \\\"I002\\\" || 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I007\\\")  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - ATIS\",\"name\":\"Quantity_ATIS\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  &&  ('Product2Sales.Global.BrandCodeGDW__c' == \\\"I002\\\" || 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I007\\\")  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - ATIS\",\"name\":\"Sales_ATIS\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  &&  ('Product2Sales.Global.BrandCodeGDW__c' == \\\"I002\\\" || 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I007\\\")  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Stock Abut - XiVE\",\"name\":\"Quantity_StockAbut_XiVE\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I004\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Stock Abut - XiVE\",\"name\":\"Sales_StockAbut_XiVE\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Stock Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I004\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - XiVE\",\"name\":\"Quantity_XiVE\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I004\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - XiVE\",\"name\":\"Sales_XiVE\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"II\\\"  && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I004\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Atlantis Abut\",\"name\":\"Quantity_AtlantisAbut\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I001\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Atlantis Abut\",\"name\":\"Sales_AtlantisAbut\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Abutments\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"IBP51\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Atlantis\",\"name\":\"Quantity_Atlantis\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  &&  'Product2Sales.Global.BrandCodeGDW__c' == \\\"I001\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Atlantis\",\"name\":\"Sales_Atlantis\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  &&  'Product2Sales.Global.BrandCodeGDW__c' == \\\"I001\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Atlantis Suprast\",\"name\":\"Quantity_AtlantisSuprast\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  &&  'Product2Sales.Global.BrandCodeGDW__c' == \\\"I009\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Atlantis Suprast\",\"name\":\"Sales_AtlantisSuprast\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  &&  'Product2Sales.Global.BrandCodeGDW__c' == \\\"I009\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Simplant\",\"name\":\"Quantity_Simplant\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  &&  'Product2Sales.Global.BrandCodeGDW__c' == \\\"I006\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Simplant\",\"name\":\"Sales_Simplant\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  &&  'Product2Sales.Global.BrandCodeGDW__c' == \\\"I006\\\" then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Quantity - Simplant Guides\",\"name\":\"Quantity_SimplantGuides\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Guides\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"I006\\\"  then 'Quantity__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"Sales - Simplant Guides\",\"name\":\"Sales_SimplantGuides\",\"precision\":12,\"saqlExpression\":\"case when 'Product2Sales.Global.SBU_Code__c' == \\\"I\\\" && 'Product2Sales.Global.GPP_Code__c' == \\\"ID\\\"  && 'Product2Sales.Global.Product_Category__c' == \\\"Guides\\\" && 'Product2Sales.Global.BrandCodeGDW__c' == \\\"IBP61\\\"  then 'Total_Value__c' else 0 end\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"isFirstInvoice\",\"name\":\"isFirstInvoice\",\"saqlExpression\":\"case when 'Invoice_Number__c' == 'FirstInvoiceNumber' then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"},{\"label\":\"MissingOneSFId\",\"name\":\"MissingOneSFId\",\"saqlExpression\":\"case when 'OneSF_Id__c' is null then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Calculate Relative Fields\"]},\"Remove Old CompanyCode\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"CompanyCode__c\"}],\"mode\":\"drop\"},\"sources\":[\"Change CompanyCodes\"]},\"Import SFDC Orders\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"SFDCOrders\"}},\"Join ANZ Sales Group to GAA\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Hierarchy.Territory.TerritoryCode\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ANZSalesGroup\",\"rightKey\":[\"TerritoryCode\"],\"rightSelect\":[\"SpecialistType\",\"SalesBranch\",\"CommissionGroup\",\"TerritoryCode\"]},\"sources\":[\"Filter for ANZ Country Codes\",\"Import ANZ SalesGroup CommissionGroup\"]},\"Drop Original Order Fields\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"a.OneSF_Id__c\"},{\"name\":\"o.Order_Type__c\"},{\"name\":\"o.AccountId\"},{\"name\":\"o.OrderNumber\"},{\"name\":\"Product2Id\"},{\"name\":\"Total_Line_Item_Price__c\"},{\"name\":\"Quantity\"},{\"name\":\"o.CreatedDate\"},{\"name\":\"o.submitted_date__c\"},{\"name\":\"OrderDate\"},{\"name\":\"CreatedBy.Name\"}],\"mode\":\"drop\"},\"sources\":[\"Rename SFDC Order Fields\"]},\"Import CountryAccountTypeDataSource\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"CountryAccountTypeDataSource\"}},\"Join Products to IndonesiaSales\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LocalSKUKey__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Product2Sales\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Global.SBU_Code__c\",\"Business_Area_Name__c\",\"Global.PG2_Desc__c\",\"PG3_Desc__c\",\"Global.Brand__c\",\"Global.BrandDescGDW__c\",\"Global.D_Level4__c\",\"Global.QuotaProducts.CountryQuotaProduct\",\"Global.Business_Area_Description__c\",\"Global.Dashboard_Product__c\",\"Business_Area_Code__c\",\"Global.SBU_Name__c\",\"GPP_Desc__c\",\"PG2_Code__c\",\"GPP_Code__c\",\"D_Level3__c\",\"Id\",\"Global.GPP_Desc__c\",\"Global.PG2_Code__c\",\"PG4_Desc__c\",\"Description\",\"SBU_Code__c\",\"Article__c\",\"Business_Area_Description__c\",\"PG3_Code__c\",\"D_Level4__c\",\"Global.Product_Category__c\",\"RecordTypeId\",\"OBIProducts.ProductId\",\"Market__c\",\"D_Level1__c\",\"Global.D_Level1__c\",\"Product_Category__c\",\"Global.PG3_Code__c\",\"ERP_Source_Description__c\",\"BrandCodeGDW__c\",\"Global.BrandCodeGDW__c\",\"SKUKey__c\",\"Global.PG1_Desc__c\",\"Global.PG4_Desc__c\",\"PG1_Desc__c\",\"Global.Business_Area_Code__c\",\"Name\",\"D_Level2__c\",\"PG4_Code__c\",\"Global.Product_Line__c\",\"SBU_Name__c\",\"BrandDescGDW__c\",\"Global.D_Level3__c\",\"Global.Business_Area_Name__c\",\"Global.Business_Area_Brand__c\",\"Product_Line__c\",\"Global.GPP_Code__c\",\"Global.PG3_Desc__c\",\"IsActive\",\"Global.PG4_Code__c\",\"PG2_Desc__c\",\"Global.D_Level2__c\",\"RecordType.Name\",\"GlobalSKUMapping__c\",\"Business_Area_Brand__c\",\"Iberia_SBU_Groups\",\"Company_Code__c\",\"PG1_Code__c\",\"Brand__c\",\"Global.PG1_Code__c\",\"Unit_of_Measurement__c\",\"Dashboard_Product__c\",\"ERP_Source__c\",\"ClinicalSolutionProduct_Class2\",\"ClinicalSolutionProduct_EndoResto\",\"ClinicalSolutionProduct_Implants\",\"ClinicalSolutionProduct_SUC\"]},\"sources\":[\"Import IndonesiaSales\",\"Import Products\"]},\"Calendar\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"Calendar\"}},\"CalcEUR\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Price_EUR\",\"name\":\"Price_EUR\",\"precision\":10,\"saqlExpression\":\"'PriceEUR.ConversionRate'*Price_USD\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Total_price_EUR\",\"name\":\"Total_price_EUR\",\"precision\":10,\"saqlExpression\":\"'PriceEUR.ConversionRate'*Total_Price_USD\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true,\"runtime\":{\"name\":\"CalcEUR\"}},\"sources\":[\"JoinCalcUSDToCurrencyType\"]},\"Join ANZ CommissionGroup to Sales\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Product2Sales.Article__c\",\"Product2Sales.Company_Code__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"ANZCommissionGroup\",\"rightKey\":[\"SKU\",\"Company_Code__c\"],\"rightSelect\":[\"CommissionGroup\"]},\"sources\":[\"Join Territories to Accounts\",\"Append ANZ Item CommissionGroup\"]},\"CalcCorporateUSD\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Price_USD\",\"name\":\"Price_USD\",\"precision\":10,\"saqlExpression\":\"'PriceUSD.ConversionRate'*Price__c\",\"scale\":2,\"type\":\"Numeric\"},{\"label\":\"Total_Price_USD\",\"name\":\"Total_Price_USD\",\"precision\":10,\"saqlExpression\":\"'PriceUSD.ConversionRate'*Total_Price__c\",\"scale\":2,\"type\":\"Numeric\"}],\"mergeWithSource\":true,\"runtime\":{\"name\":\"CalcCorporateSEK\"}},\"sources\":[\"JoinCurrencyCodetoCurrencytype\"]},\"Combine DNA Extracts\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":false},\"sources\":[\"Extract DNA Sales 1\",\"Extract DNA Sales 2\",\"Extract DNA Sales 3\"]},\"Join Territory Users\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Territory\",\"rightKey\":[\"Territory2Id\"],\"rightSelect\":[\"User.Full_Name__c\",\"User.Id\"]},\"sources\":[\"Extract Territory2 - Territory\",\"Join User To Territory\"]},\"Create InvoiceNumber Prefix\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"InvoiceNumberPrefix\",\"name\":\"InvoiceNumberPrefix\",\"saqlExpression\":\"substr('Invoice_Number__c',1,3)\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Remove New CompanyCode\"]},\"Drop Original US Indirect Fields\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"CurrencyIsoCode\"},{\"name\":\"DataSource\"},{\"name\":\"DealerBranchCountry\"},{\"name\":\"DealerBranchName\"},{\"name\":\"DealerBranchNum\"},{\"name\":\"DistributorName\"},{\"name\":\"DistributorNumber\"},{\"name\":\"Invoice_Date__c\"},{\"name\":\"Invoice_Number__c\"},{\"name\":\"LocalSKUKey__c\"},{\"name\":\"OneSF_Id__c\"},{\"name\":\"Quantity__c\"},{\"name\":\"Sales_Type__c\"},{\"name\":\"Total_Value__c\"},{\"name\":\"View_Wave_Data__c\"}],\"mode\":\"select\"},\"sources\":[\"Rename DNA Fields\"]},\"JoinCalcUSDToCurrencyType\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"EUR\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"PriceEUR\",\"rightKey\":[\"IsoCode\"],\"rightSelect\":[\"ConversionRate\"],\"runtime\":{\"name\":\"JoinCalcUSDToCurrencyType\"}},\"sources\":[\"CalcCorporateUSD\",\"Extract_currencytype\"]},\"Import Products\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"Products\"}},\"Join Products to DNA Sales\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LocalSKUKey__c\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Product2Sales\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Global.SBU_Code__c\",\"Business_Area_Name__c\",\"Global.PG2_Desc__c\",\"PG3_Desc__c\",\"Global.Brand__c\",\"Global.BrandDescGDW__c\",\"Global.D_Level4__c\",\"Global.QuotaProducts.CountryQuotaProduct\",\"Global.Business_Area_Description__c\",\"Global.Dashboard_Product__c\",\"Business_Area_Code__c\",\"Global.SBU_Name__c\",\"GPP_Desc__c\",\"PG2_Code__c\",\"GPP_Code__c\",\"D_Level3__c\",\"Id\",\"Global.GPP_Desc__c\",\"Global.PG2_Code__c\",\"PG4_Desc__c\",\"Description\",\"SBU_Code__c\",\"Article__c\",\"Business_Area_Description__c\",\"PG3_Code__c\",\"D_Level4__c\",\"Global.Product_Category__c\",\"RecordTypeId\",\"OBIProducts.ProductId\",\"Market__c\",\"D_Level1__c\",\"Global.D_Level1__c\",\"Product_Category__c\",\"Global.PG3_Code__c\",\"ERP_Source_Description__c\",\"BrandCodeGDW__c\",\"Global.BrandCodeGDW__c\",\"SKUKey__c\",\"Global.PG1_Desc__c\",\"Global.PG4_Desc__c\",\"PG1_Desc__c\",\"Global.Business_Area_Code__c\",\"Name\",\"D_Level2__c\",\"PG4_Code__c\",\"Global.Product_Line__c\",\"SBU_Name__c\",\"BrandDescGDW__c\",\"Global.D_Level3__c\",\"Global.Business_Area_Name__c\",\"Global.Business_Area_Brand__c\",\"Product_Line__c\",\"Global.GPP_Code__c\",\"Global.PG3_Desc__c\",\"IsActive\",\"Global.PG4_Code__c\",\"PG2_Desc__c\",\"Global.D_Level2__c\",\"RecordType.Name\",\"GlobalSKUMapping__c\",\"Business_Area_Brand__c\",\"Iberia_SBU_Groups\",\"Company_Code__c\",\"PG1_Code__c\",\"Brand__c\",\"Global.PG1_Code__c\",\"Unit_of_Measurement__c\",\"Dashboard_Product__c\",\"ERP_Source__c\",\"ClinicalSolutionProduct_Class2\",\"ClinicalSolutionProduct_EndoResto\",\"ClinicalSolutionProduct_Implants\",\"ClinicalSolutionProduct_SUC\"]},\"sources\":[\"Drop Original US Indirect Fields\",\"Import Products\"]},\"Join Territories to Account Assocaition\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Territory2Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Territory\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Area.Area.User.Full_Name__c\",\"Area.Name\",\"Id\",\"Name\",\"Region.Name\",\"Region.Region.User.Full_Name__c\",\"Territory.User.Full_Name__c\",\"Territory.User.Id\",\"Region.Region.User.Id\",\"Area.Area.User.Id\"]},\"sources\":[\"Extract ObjectTerritory2Association\",\"Join Area to Region\"]},\"613 Company Code\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Company_Code__c\",\"name\":\"Company_Code__c\",\"saqlExpression\":\"\\\"613\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Import ANZ Item CommissionGroup 613\"]},\"Join Products to Sales History\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"LocalSKU_Key_up\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Product2Sales\",\"rightKey\":[\"SKUKey__c\"],\"rightSelect\":[\"Global.SBU_Code__c\",\"Business_Area_Name__c\",\"Global.PG2_Desc__c\",\"PG3_Desc__c\",\"Global.Brand__c\",\"Global.BrandDescGDW__c\",\"Global.D_Level4__c\",\"Global.QuotaProducts.CountryQuotaProduct\",\"Global.Business_Area_Description__c\",\"Global.Dashboard_Product__c\",\"Business_Area_Code__c\",\"Global.SBU_Name__c\",\"GPP_Desc__c\",\"PG2_Code__c\",\"GPP_Code__c\",\"D_Level3__c\",\"Id\",\"Global.GPP_Desc__c\",\"Global.PG2_Code__c\",\"PG4_Desc__c\",\"Description\",\"SBU_Code__c\",\"Article__c\",\"Business_Area_Description__c\",\"PG3_Code__c\",\"D_Level4__c\",\"Global.Product_Category__c\",\"RecordTypeId\",\"OBIProducts.ProductId\",\"Market__c\",\"D_Level1__c\",\"Global.D_Level1__c\",\"Product_Category__c\",\"Global.PG3_Code__c\",\"ERP_Source_Description__c\",\"BrandCodeGDW__c\",\"Global.BrandCodeGDW__c\",\"SKUKey__c\",\"Global.PG1_Desc__c\",\"Global.PG4_Desc__c\",\"PG1_Desc__c\",\"Global.Business_Area_Code__c\",\"Name\",\"D_Level2__c\",\"PG4_Code__c\",\"Global.Product_Line__c\",\"SBU_Name__c\",\"BrandDescGDW__c\",\"Global.D_Level3__c\",\"Global.Business_Area_Name__c\",\"Global.Business_Area_Brand__c\",\"Product_Line__c\",\"Global.GPP_Code__c\",\"Global.PG3_Desc__c\",\"IsActive\",\"Global.PG4_Code__c\",\"PG2_Desc__c\",\"Global.D_Level2__c\",\"RecordType.Name\",\"GlobalSKUMapping__c\",\"Business_Area_Brand__c\",\"Iberia_SBU_Groups\",\"Company_Code__c\",\"PG1_Code__c\",\"Brand__c\",\"Global.PG1_Code__c\",\"Unit_of_Measurement__c\",\"Dashboard_Product__c\",\"ERP_Source__c\",\"ClinicalSolutionProduct_Class2\",\"ClinicalSolutionProduct_EndoResto\",\"ClinicalSolutionProduct_Implants\",\"ClinicalSolutionProduct_SUC\"],\"runtime\":{\"name\":\"JoinSalesHistoryAccountsToProducts\"}},\"sources\":[\"New_LocalSKUKey_c\",\"Import Products\"]},\"Import ANZ Item CommissionGroup 613\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"ANZ_Item_CommissionGroup\"}},\"Join Monthly ANZ SalesGroups to Sales\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OneSF_Id__c\",\"time.Year\",\"time.Month\",\"ANZCommissionGroup.CommissionGroup\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"MonthlyCommissionGroup\",\"rightKey\":[\"OneSF_Id__c\",\"AlignmentYear\",\"AlignmentMonth\",\"ANZSalesGroup.CommissionGroup\"],\"rightSelect\":[\"ANZSalesGroup.SalesBranch\",\"ANZSalesGroup.SpecialistType\",\"ANZSalesGroup.TerritoryCode\"]},\"sources\":[\"Join ANZ SalesGroups to Sales\",\"Join ANZ Sales Group to GAA\"]},\"614 Company Code\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Company_Code__c\",\"name\":\"Company_Code__c\",\"saqlExpression\":\"\\\"614\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"ANZ Item CommissionGroup 614\"]},\"Import IndonesiaSales\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"IndonesiaSales\"}},\"ANZ Item CommissionGroup 614\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"ANZ_Item_CommissionGroup\"}},\"Import Accounts\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"Accounts_NoSharing\"}},\"Extract ObjectTerritory2Association\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"ObjectId\"},{\"name\":\"Territory2Id\"}],\"object\":\"ObjectTerritory2Association\"}}}}",null]